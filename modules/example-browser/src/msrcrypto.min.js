//*******************************************************************************
//
//    Copyright 2020 Microsoft
//
//    Licensed under the Apache License, Version 2.0 (the "License");
//    you may not use this file except in compliance with the License.
//    You may obtain a copy of the License at
//
//        http://www.apache.org/licenses/LICENSE-2.0
//
//    Unless required by applicable law or agreed to in writing, software
//    distributed under the License is distributed on an "AS IS" BASIS,
//    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//    See the License for the specific language governing permissions and
//    limitations under the License.
//
//*******************************************************************************
"use strict";var msrCryptoVersion="1.6.0";!function(e,r){"function"==typeof define&&define.amd?define([],function(){return e.msrCrypto=r(e)}):"object"==typeof exports?module.exports=r(e):e.msrCrypto=r(e)}(this,function(e){e=e||{};return function(){var r={register:function(e,t,n){r[e]||(r[e]={});var o=r[e];o[t]||(o[t]=n)},exists:function(e,t){return!!r[e]&&!!r[e][t]}},t=function(){if("undefined"!=typeof document)try{throw new Error}catch(r){if(r.stack){var e=/\w+:\/\/(.+?\/)*.+\.js/.exec(r.stack);return e&&e.length>0?e[0]:null}}else if("undefined"!=typeof self)return self.location.href;return null}(),n="undefined"!=typeof Worker,o="function"==typeof importScripts&&self instanceof WorkerGlobalScope,a=!1,s="undefined"!=typeof ArrayBuffer,u=function(){try{return Object.defineProperty({},"oncomplete",{}),!0}catch(e){return!1}}(),c=!1,l=function(e,r,t,n,o){if(u){var a={};n&&(a.get=n),o&&(a.set=o),Object.defineProperty(e,r,a)}else e[r]=t},f={},h=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(r){for(r=r.replace(/-/g,"+").replace(/_/g,"/");r.length%4!=0;)r+="=";var t,n,o,a,i,s,u,c=[];for(r=r.replace(/[^A-Za-z0-9\+\/\=]/g,""),u=0;u<r.length;u+=4)t=e.indexOf(r.charAt(u))<<2|(a=e.indexOf(r.charAt(u+1)))>>4,n=(15&a)<<4|(i=e.indexOf(r.charAt(u+2)))>>2,o=(3&i)<<6|(s=e.indexOf(r.charAt(u+3))),c.push(t),64!==i&&c.push(n),64!==s&&c.push(o);return c}function t(e){return Object.prototype.toString.call(e).slice(8,-1)}function n(e){return[e>>>24&255,e>>>16&255,e>>>8&255,255&e]}function o(e){if(!e)return[];if(e.pop)return e;if("ArrayBuffer"===t(e)?e=new Uint8Array(e):e.BYTES_PER_ELEMENT>1&&(e=new Uint8Array(e.buffer)),1===e.length)return[e[0]];if(e.length<65536)return Array.apply(null,e);for(var r=new Array(e.length),n=0;n<e.length;n++)r[n]=e[n];return r}return{consoleLog:function(e){"console"in self&&"log"in console&&console.log(e)},toBase64:function(r,n){var a=t(r);if("Array"!==a&&"Uint8Array"!==a&&"ArrayBuffer"!==a)throw new Error("invalid input");var i,s,u,c,l,f,h,y,g="",p=o(r);for(n||(n=!1),y=0;y<p.length;y+=3)c=(i=p[y])>>2,l=(3&i)<<4|(s=p[y+1])>>4,f=(15&s)<<2|(u=p[y+2])>>6,h=63&u,isNaN(s)?f=h=64:isNaN(u)&&(h=64),g=g+e.charAt(c)+e.charAt(l)+e.charAt(f)+e.charAt(h);return n?g.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):g},fromBase64:r,checkParam:function(e,r,n){if(!e)throw new Error(n);if(r&&t(e)!==r)throw new Error(n);return!0},getObjectType:t,bytesToHexString:function(e,r){var t="";void 0===r&&(r=!1);for(var n=0;n<e.length;n++){r&&n%4==0&&0!==n&&(t+="-");var o=e[n].toString(16).toUpperCase();1===o.length&&(t+="0"),t+=o}return t},bytesToInt32:function(e,r){return e[r=r||0]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]},stringToBytes:function(e){for(var r=[],t=0,n=0;t<e.length;t++){var o=e.charCodeAt(t);o<128?r[n++]=o:o<2048?(r[n++]=o>>>6|192,r[n++]=63&o|128):o<55296||o>57343?(r[n++]=o>>>12|224,r[n++]=o>>>6&63|128,r[n++]=63&o|128):(o=1024*(o-55296)+(e.charCodeAt(++t)-56320)+65536,r[n++]=o>>>18|240,r[n++]=o>>>12&63|128,r[n++]=o>>>6&63|128,r[n++]=63&o|128)}return r},bytesToString:function(e){var r,t="";e=o(e);for(var n=0;n<e.length;){var a=e[n++];if((r=a<128?a:a<224?(a<<6)+e[n++]-12416:a<240?(a<<12)+(e[n++]<<6)+e[n++]-925824:(a<<18)+(e[n++]<<12)+(e[n++]<<6)+e[n++]-63447168)>65535){var i=Math.floor((r-65536)/1024)+55296,s=(r-65536)%1024+56320;t+=String.fromCharCode(i,s)}else t+=String.fromCharCode(r)}return t},unpackData:function(e,t,n){var o,a=r(e),i=[];if(isNaN(t))return a;for(o=0;o<a.length;o+=t)i.push(a.slice(o,o+t));if(n)for(o=0;o<i.length;o++)i[o]=(i[o][0]<<24)+(i[o][1]<<16)+(i[o][2]<<8)+i[o][3];return i},hexToBytesArray:function(e){e=e.replace(/\-/g,"");for(var r=[];e.length>=2;)r.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return r},int32ToBytes:n,int32ArrayToBytes:function(e){for(var r=[],t=0;t<e.length;t++)r=r.concat(n(e[t]));return r},toArray:o,arraysEqual:function(e,r){var t=!0;e.length!==r.length&&(t=!1);for(var n=0;n<e.length;n++)e[n]!==r[n]&&(t=!1);return t},clone:function(e){var r={};for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r},xorVectors:function(e,r,t){for(var n=Math.min(e.length,r.length),o=(t=t||new Array(n),0);o<n;o+=1)t[o]=e[o]^r[o];return t},padEnd:function(e,r,t){for(;e.length<t;)e.push(r);return e},padFront:function(e,r,t){for(;e.length<t;)e.unshift(r);return e},getVector:function(e,r){isNaN(r)&&(r=0);for(var t=new Array(e),n=0;n<e;n+=1)t[n]=r;return t},verifyByteArray:function(e){if("Array"!==t(e))return!1;for(var r,n=0;n<e.length;n++)if(r=e[n],isNaN(r)||r<0||r>255)return!1;return!0}}}(),y=(p={0:"CUSTOM",1:"BOOLEAN",2:"INTEGER",3:"BIT STRING",4:"OCTET STRING",5:"NULL",6:"OBJECT IDENTIFIER",16:"SEQUENCE",17:"SET",19:"PRINTABLE STRING",23:"UTCTime"},{parse:function e(r,t){t=!!t;var n,o,a,i=p[31&r[0]],s=r[1],u=0,c=!!(32&r[0]);if(128&s)for(u=0,s=0;u<(127&r[1]);u++)s=(s<<8)+r[2+u];if(a=2+u,void 0===i||s>r.length)return null;var l=c?[]:{};if(l.type=i,l.header=a,l.data=r.slice(0,s+a),c||t)for("BIT STRING"===l.type&&0===r[a]&&u++,n=r.slice(a,l.data.length);n.length>0&&null!==(o=e(n));)l.push(o),n=n.slice(o.data.length);return l},encode:function(e){throw new Error("not implemented")},toString:function(e){return function e(r,t){var n=new Array(t+1).join(" ")+r.type+" ("+r.length+") "+bytesToHexString(r.data).substring(0,16)+"\n";if(!r.children)return n;for(var o=0;o<r.children.length;o++)n+=e(r.children[o],t+4)+"";return n}(e,0)}}),g=function(){function e(e){return a&&o&&self.postMessage(e),e}return{jsCryptoRunner:function(t){t.data.workerid,t.data.operationType,t.data.operationSubType;var n=t.data.operationType,o=r[n][t.data.algorithm.name],a=t.data;if(!r.exists(n,t.data.algorithm.name))throw new Error("unregistered algorithm.");return a.operationSubType?e({type:a.operationSubType,result:o(a)}):e(o(a))},returnResult:e}}();var p;o&&(self.onmessage=function(e){if(!a&&e.data.prngSeed){var r=e.data.prngSeed;return J.init(r),a=!0,g.returnResult({initialized:!0})}!0===a&&g.jsCryptoRunner(e)});var d=function(){var e=h;function r(e){var r=e.algorithm.name.slice(0,3).toLowerCase();return"rsa"===r?"RSA":"ecd"===r?"EC":"oct"}function t(e){return e.hash.name.substring(e.hash.name.indexOf("-")+1)}var n={hmac:function(e){return"HS"+t(e)},"aes-cbc":function(e){return"A"+e.length.toString()+"CBC"},"aes-gcm":function(e){return"A"+e.length.toString()+"GCM"},"rsassa-pkcs1-v1_5":function(e){return"RS"+t(e)},"rsa-oaep":function(e){return"SHA-1"===e.hash.name.toUpperCase()?"RSA-OAEP":"RSA-OAEP-"+t(e)},"rsa-pss":function(e){return"PS"+t(e)},ecdsa:function(e){return"EC-"+e.namedCurve.substring(e.namedCurve.indexOf("-")+1)}};return{keyToJwkOld:function(t,n){var o={};if(o.kty=r(t),o.extractable=t.extractable,n.pop)o.k=e.toBase64(n,!0);else for(var a in n)n[a].pop&&(o[a]=e.toBase64(n[a],!0));return t.algorithm.namedCurve&&(o.crv=t.algorithm.namedCurve),function(e){for(var r=[],t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return 0===r[r.length-1]&&r.pop(),r}(JSON.stringify(o,null,"\t"))},keyToJwk:function(t,o){var a={};if(a.kty=r(t),a.ext=t.extractable,n[t.algorithm.name.toLowerCase()]&&(a.alg=n[t.algorithm.name.toLowerCase()](t.algorithm)),a.key_ops=t.usages,o.pop)a.k=e.toBase64(o,!0);else for(var i in o)o[i].pop&&"key_ops"!==i&&(a[i]=e.toBase64(o[i],!0));return t.algorithm.namedCurve&&(a.crv=t.algorithm.namedCurve),a},jwkToKey:function(r,t,n){for(var o=JSON.parse(JSON.stringify(r)),a=0;a<n.length;a+=1){var i=o[n[a]];i&&(o[n[a]]=e.fromBase64(i))}return o}}}();var v=v||function(){for(var e=24,r=Math.floor(e/8),t=(1<<e)-1,n=1<<e,o=t,a=1/n,i=[1,256],s=2;s<=r;s++)i[s]=256*i[s-1];var u=[0],c=[1];function l(e){var r,t=null;if(arguments.length&&"number"!=typeof arguments[0]){if("object"==typeof arguments[0])for(t=new Array(e.length),r=0;r<e.length;r+=1)t[r]=e[r]}else for(t=new Array(e),r=0;r<e;r+=1)t[r]=0;return t}function f(e,r,t,n,o){for(;o-- >0;)t[n+o]=e[r+o]}function h(e){var r,t=0;for(r=0;r<e.length;r+=1)t|=e[r];return!t}function y(e){var t=Math.floor((e.length+r-1)/r),o=new Array(t);o[0]=0;for(var a=0,s=0,u=0,c=e.length-1;c>=0;c--)a+=i[u++]*(255&e[c]),i[u]===n&&(u=0,o[s++]=a,a=0);for(0!==a&&(o[s]=a);null==o[--t];)o[t]=0;return o}function g(r,t){if(void 0===t)if(r<=1)t=1;else{var o=Math.log(r)/Math.LN2;t=Math.ceil(o/e)}for(var a=[];r>0;)a.push(r%n),r=Math.floor(r/n);for(;a.length<t;)a.push(0);return a}function p(e){for(var r=e.length-1;r>=0;r--)if(void 0!==e[r]&&0!==e[r])return r;return 0===e[0]?-1:0}function d(e,r){var t,n,o=0;for(n=0;n<Math.max(e.length,r.length);n++)o=(t=~~e[n]-~~r[n])+(o&-!t);return o}function m(e,r,t){var n=p(e);if(e.length=r||n+1,t)for(;++n<e.length;)e[n]=0;return e.length<=0&&(e[0]=0,e.length=1),e}function w(r,n,o,a){if(void 0===o)o=1;else if(o>=e||o<0)throw new Error("bit count must be smaller than DIGIT_BITS and positive in shiftLeft");void 0===a&&(a=r.length);var i=e-o;n[a]=r[a-1]>>>e-o||n[a];for(var s=a-1;s>0;s--)n[s]=(r[s]<<o|r[s-1]>>>i)&t;n[0]=r[0]<<o&t}function b(r,n,o){var a=r,i=n;n.length<r.length&&(a=n,i=r);var s,u=a.length,c=0;for(s=0;s<u;s+=1)c+=a[s]+i[s],o[s]=c&t,c>>=e;for(s=u;s<i.length;s+=1)c+=i[s],o[s]=c&t,c>>=e;return o.length=i.length,0!==c&&(o[s]=c&t),c}function k(r,n,o){var a=n.length;if(r.length<n.length&&(a=p(n)+1,r.length<a))throw new Error("Subtrahend is longer than minuend, not supported.");var i,s=0;for(i=0;i<a;i+=1)s+=r[i]-n[i],o[i]=s&t,s>>=e;for(;i<r.length;)s+=r[i],o[i++]=s&t,s>>=e;return s}function x(e,r,n){r="number"==typeof r?[r]:r;var o,i,s,u,c,l,f,h,y=e.length,g=r.length;for(o=0;o<y+g;o+=1)n[o]=0;o=0,u=0;for(var p=0;o<g;){for(u=Math.min(u+31,g);o<u;o++)for(h=r[o],i=0;i<y;i++)n[o+i]+=e[i]*h;for(c=0,s=p;s<o+y;s++)f=(l=n[s]+c)&t,n[s]=f,c=(l-f)*a;n[s]=c,p+=31}return n.length=y+g,n}function E(r,o,a,i,s,u){var c,l,h,y,g,d,v,b=p(r)+1,k=p(o)+1;if(b<k)return f(r,0,i,0,r.length),i.length=r.length,m(i),a[0]=0,void(a.length=1);if(0===k||1===k&&0===o[k-1])throw new Error("Division by zero.");if(1===k){for(g=o[0],l=0,v=b-1;v>=0;v--)y=l*n+r[v],a[v]=y/g&t,l=y-a[v]*g&t;return a.length=b,m(a),i[0]=l,void(i.length=1)}var x=e-1-function(r){for(var t=0,n=0;n<e;n++)t=Math.max(t,-(r>>>n&1)&n);return t}(o[k-1]),E=s||[];E.length=k,w(o,E,x,k);var M=u||[];for(M.length=b,w(r,M,x,b),M[b]=M[b]||0,a.length=b-k+1,i.length=k,v=b-k;v>=0;v--){for(c=Math.floor((M[v+k]*n+M[v+k-1])/E[k-1]),l=M[v+k]*n+M[v+k-1]-c*E[k-1];(c>=n||c*E[k-2]>l*n+M[v+k-2])&&(c-=1,(l+=E[k-1])<n););for(h=0,d=0;d<k;d++)y=c*E[d],g=M[d+v]-h-(y&t),M[d+v]=g&t,h=Math.floor(y/n)-Math.floor(g/n);if(g=M[v+k]-h,M[v+k]=g&t,a[v]=c&t,g<0){for(a[v]=a[v]-1,h=0,d=0;d<k;d++)g=M[d+v]+E[d]+h,M[d+v]=g&t,h=g>>e;M[v+k]=M[v+k]+h&t}}for(d=0;d<k;d++)i[d]=(M[d]>>>x|M[d+1]<<e-x)&t;m(a),m(i)}function M(e,r,t,n,o){var a;if(h(e))return f(r,0,o,0,r.length),o.length=r.length,0;if(h(r))return f(e,0,o,0,e.length),o.length=e.length,0;d(e,r)<0?(a=e.slice(0),f(r,0,o,0,r.length),o.length=r.length):(a=r.slice(0),f(e,0,o,0,e.length),o.length=e.length),m(o),m(a);var i,s,u=new Array(o.length),c=new Array(o.length),l=new Array(o.length),y=void 0!==n;y&&((i=new Array(o.length))[0]=1,i.length=1,n[0]=0,n.length=1);var g=new Array(o.length),p=void 0!==t;p&&((s=new Array(o.length))[0]=0,s.length=1,t[0]=1,t.length=1);for(var v,w=-1,k=t,M=n,D=o;!h(a);)E(o,a,u,c,g,l),p&&(x(u,s,g),b(g,t,g),m(g),v=t,t=s,s=g,g=v),y&&(x(u,i,l),b(l,n,l),m(l),v=n,n=i,i=l,l=v),v=o,o=a,a=c,c=v,w++;return p&&(f(t,0,k,0,t.length),k.length=t.length),y&&(f(n,0,M,0,n.length),M.length=n.length),f(o,0,D,0,o.length),D.length=o.length,w}function D(e,r,t,n){if(n=n||[],0===d(r,u))n[0]=1;else if(0===d(r,c))f(e,0,n,0,e.length),n.length=e.length;else{var o=new T(t);m(e,o.s,!0),o.modExp(e,r,n),n.length=t.length}return n}function T(r,n){function o(r){for(var n=1,o=2,a=3,i=a&r,s=2;s<=e;s+=1)o<i&&(n+=o),o<<=1,i=r*n&(a=a<<1|1);return 1+(~n&t)}function i(e,r,n,o){for(var i,s,c,f,h,y,g,p,d=(o=o||this).m,m=d.length,w=o.mPrime,b=o.m0,k=0,x=0,E=l(m+2);k<m;){for(x=Math.min(m,x+16);k<x;){for(i=~~r[k],c=((s=E[0]+e[0]*i)&t)*w&t,E[1]+=(b*c+s)*a|0,f=1,h=0;f<m;h=f,f+=1)E[h]=E[f]+d[f]*c+e[f]*i;E[h]=E[f],E[f]=0,k++}for(p=0,f=0;f<m;f++)g=(y=E[f]+p)&t,E[f]=g,p=(y-g)*a;E[f]=p}for(k=0;k<m;k+=1)n[k]=E[k];n.length=m;var M=+(v.compareDigits(E,d)>0);v.subtract(n,d,o.temp2),u(M,n,o.temp2)}function s(e,r,t){var n,o,a,i,s;for(n=0;n<e[0].length;n++)t[n]=0;for(o=0;o<e.length;o++)for(i=e[o],a=-(r===o),s=0;s<i.length;s++)t[s]=t[s]|i[s]&a}function u(e,r,t){for(var n=-e,o=~n,a=0;a<r.length;a++)r[a]=r[a]&o|t[a]&n}var c=(n=n||function(e){var r=e.length,t=e[0],n={m:e,mPrime:o(t),m0:t,temp1:l(2*r+1),temp2:l(2*r+1)},a=l(2*e.length);a[a.length]=1,n.µ=[],E(a,e,n.µ,[]);var s=l(2*r+1),u=l(r+1),c=l(2*r+1),f=l(2*r+1),h=u;h[r]=1,E(h,e,s,u,c,f),n.rModM=m(u,r,!0);var y=l(2*r+1),g=y;return g[2*r]=1,E(g,e,s,y,c,f),n.rSquaredModm=m(y,r,!0),n.rCubedModm=l(r),i(y,y,n.rCubedModm,n),n}(r)).m,f=n.µ,h=n.m0,y=c.length,g=l(y+1).slice(0,y);g[0]=1;var p=n.mPrime,w=n.rModM,b=n.rSquaredModm,M=n.rCubedModm,D=l(2*y+1),T=l(2*y+1),I=new Array(4);return I[0]=w,I[1]=new Array(y),I[2]=new Array(y),I[3]=new Array(y),{m:c,m0:h,mPrime:p,"µ":f,rSquaredModm:b,s:y,rModM:w,rCubedModm:M,one:g,temp1:D,temp2:T,convertToMontgomeryForm:function(e){if(e.length<this.s){e.length=this.s;for(var r=0;r<this.s;r++)e[r]=isNaN(e[r])?0:e[r]}var t=l(e.length);for(this.montgomeryMultiply(e,this.rSquaredModm,t),r=0;r<this.s;r+=1)e[r]=t[r]},convertToStandardForm:function(e){this.montgomeryMultiply(e,this.one,this.temp1);for(var r=0;r<this.s;r+=1)e[r]=this.temp1[r]},montgomeryMultiply:i,modExp:function(r,t,n,o){o=!!o;var a,i,u=function(r){var t,n,o=2,a=r*e;n=4+3*Math.ceil(a/2)+1;do{o++,t=n,n=Math.pow(2,o)+Math.ceil(a/o)*(o+1)+1}while(n<t);return o-1}(t.length),c=function(r,t){var n,o=r.length,a=(new Array(o*e),0),i=0,s=0,u=0,c=new Array(Math.ceil(o*e/t));for(s=0,c[0]=0;a<o;a++)for(i=0,n=r[a];i<e;i++,n>>>=1)s===t&&(c[++u]=0,s=0),c[u]+=(1&n)<<s++;return c}(t,u).reverse(),l=this.rModM.slice(0),f=Math.pow(2,u),h=I;for(h.length=f,h[0]=this.rModM,a=1;a<f;a++)h[a]=[],x(h[a-1],r,h[a]),this.reduce(h[a]);var y,g=[];for(a=0;a<c.length;a++){for(i=0;i<u;i++)this.montgomeryMultiply(l,l,l);y=c[a],o?g=h[y]:s(h,y,g),this.montgomeryMultiply(l,g,l)}return this.montgomeryMultiply(l,this.one,n),n},reduce:function(e,r){var t,n,o,a,i,s,l=this.m.length,f=[];for(r=r||e,t=[],x(e.slice(l-1),this.µ,t),n=t.slice(l+1),o=e.slice(0,l+1),x(n,c,a=[]),a=a.slice(0,l+1),o[l+1]=d(o,a)>>>31,i=0;i<r.length;i++)r[i]=0;k(o,a,r),s=+(d(r,c)>0),v.subtract(r,c,f),u(s,r,f),m(r)},ctx:n}}return{DIGIT_BITS:e,DIGIT_NUM_BYTES:r,DIGIT_MASK:t,DIGIT_BASE:n,DIGIT_MAX:o,Zero:u,One:c,normalizeDigitArray:m,bytesToDigits:y,stringToDigits:function(e,r){e=e.replace(/^\s+|\s+$/g,"");var t=[0],n=[0];r=r||10;for(var o=0;o<e.length;o+=1){var a=parseInt(e[o],r);if(isNaN(a))throw new Error("Failed to convert string to integer in radix "+r.toString());x(t,r,n),b(n,[a],t),m(t)}return t},digitsToString:function(e,r){if(n<=(r=r||10))throw new Error("DIGIT_BASE is smaller than RADIX; cannot convert.");var t,o=e.length,a=[],i=[],s=[],u=[],c=[],l=[],f="",h="0";for(c[0]=r;Math.floor(n/c[0])>=r;)c[0]=c[0]*r,h=h.concat("0");for(t=0;t<o;t+=1)l[t]=e[t];for(;;){var y=!0;for(t=0;t<l.length;t+=1)if(0!==l[t]){y=!1;break}if(y)break;E(l,c,a,i,s,u),m(a,l.length,!0);var g=i[0].toString(r);f=h.substring(0,h.length-g.length)+g+f;var p=l;l=a,a=p}for(;0!==f.length&&"0"===f[0];)f=f.substring(1,f.length);return 0===f.length&&(f="0"),f},intToDigits:g,digitsToBytes:function(e,t,n){var o,a,i,s=[0];for(void 0===t&&(t=!0),o=0;o<e.length;o+=1)for(i=e[o],a=0;a<r;a+=1)s[o*r+a]=255&i,i=Math.floor(i/256);if(s.reverse(),void 0===n&&(n=1),t)for(;s.length>n&&0===s[0];)s.shift();return s},isZero:h,isEven:function(e){return 0==(1&e[0])},shiftRight:function(r,n,o,a){if(void 0===o)o=1;else if(o>=e||o<0)throw new Error("Invalid bit count for shiftRight");void 0===a&&(a=r.length);for(var i=a-1,s=e-o,u=0;u<i;u++)n[u]=(r[u+1]<<s|r[u]>>>o)&t;n[i]=r[i]>>>o},shiftLeft:w,compareDigits:d,bitLength:function(e){for(var r=0,t=0;r<e.length;){if(0===t)for(var n=7;n>=0&&0===t;){var o=1<<n;(e[r]&o)===o&&(t=n+1),n--}else t+=8;r+=1}return t},fixedWindowRecode:function(e,r,t){e=e.slice();for(var n=[],o=Math.pow(2,r),a=Math.pow(2,r-1),i=0;i<t;i++)n[i]=e[0]%o-a,e[0]=e[0]-n[i],v.shiftRight(e,e,r-1);return n[i]=e[0],n},IntegerGroup:function(r){var n=y(r),o=n.length,a=g(0,o),i=g(1,o),s=l(o),u=l(o);function c(e,r){return{m_digits:e,m_group:r,equals:function(e){return 0===d(this.m_digits,e.m_digits)&&this.m_group.equals(this.m_group,e.m_group)}}}return{m_modulus:n,m_digitWidth:o,montmul:new T(n),createElementFromInteger:function(e){return c(g(e,this.m_digitWidth),this)},createElementFromBytes:function(e){var r=y(e);if(v.compareDigits(r,this.m_modulus)>=0)throw new Error("The number provided is not an element of this group");return m(r,this.m_digitWidth,!0),c(r,this)},createElementFromDigits:function(e){return v.normalizeDigitArray(e,this.m_digitWidth,!0),c(e,this)},equals:function(e){return 0===d(this.m_modulus,e.m_modulus)},add:function(r,n,o){var a,i=this.m_digitWidth,s=o.m_digits;v.add(r.m_digits,n.m_digits,s);var u=(d(s,this.m_modulus)>>>31)-1&t,c=0;for(a=0;a<i;a+=1)c=s[a]-(this.m_modulus[a]&u)+c,s[a]=c&t,c>>=e;s.length=i},subtract:function(r,n,o){var a,i=this.m_digitWidth,s=o.m_digits,u=v.subtract(r.m_digits,n.m_digits,o.m_digits);if(-1===u)for(u=0,a=0;a<i;a+=1)u+=s[a]+this.m_modulus[a],s[a]=u&t,u>>=e},multiply:function(e,r,t){return v.modMul(e.m_digits,r.m_digits,this.m_modulus,t.m_digits,s,u)},inverse:function(e,r){v.modInv(e.m_digits,this.m_modulus,r.m_digits)},modexp:function(e,r,t){if(t=t||c([],this),0===d(r,a))t.m_digits=g(1,this.m_digitWidth);else if(0===d(r,i)){for(var n=0;n<e.m_digits.length;n++)t.m_digits[n]=e.m_digits[n];t.m_digits.length=e.m_digits.length}else this.montmul.modExp(e.m_digits,r,t.m_digits),t.m_digits.length=this.montmul.s;return t}}},add:b,subtract:k,multiply:x,divRem:E,reduce:function(e,r,t,n,o){return E(e,r,[],t,n,o),t},modInv:function(e,r,t,n){var o=new Array(r.length),a=new Array(r.length),i=new Array(r.length),s=M(e,r,a,o,i);return t=t||[],0!==d(i,c)?(t[0]=NaN,t.length=1):(1==(1&s)?k(r,o,t):(f(o,0,t,0,o.length),t.length=o.length),n?m(t,r.length,!0):m(t)),t},modInvCT:function(e,r,t,n){var o=[];return t=t||[],k(r,[2],o),D(e,o,r,t),m(t),t},modExp:D,modMul:function(e,r,t,n,o,a){var i=[];return x(e,r,i),E(i,t,i,n,o,a),n},MontgomeryMultiplier:T,gcd:function(e,r,t){var n=e,o=r;return d(e,r)>0&&(n=r,o=e),M(n,o,void 0,void 0,t),m(t)},sequenceEqual:function(e,r){for(var t=e.length===r.length,n=0;n<Math.min(e.length,r.length);n+=1)e[n]!==r[n]&&(t=!1);return t},swapEndianness:function(e){return e.reverse()},computeBitArray:function(e){for(var r=l(8*e.length),t=0,n=e.length-1;n>=0;){for(var o=0;o<8;){var a=1<<o,i=(e[n]&a)===a?1:0,s=8*(e.length-n-1)+o;1===i&&(t=s+1),r[s]=i,o+=1}n--}return r.slice(0,t)}}}();var m=m||function(){var e=v.bytesToDigits;function r(e){var r,t=null;if(arguments.length&&"number"!=typeof arguments[0]){if("object"==typeof arguments[0])for(t=[],r=0;r<e.length;r+=1)t[r]=e[r]}else for(t=[],r=0;r<e;r+=1)t[r]=0;return t}var t=function(e,r,t,o,a,i){var s=e.length;return{p:e,a:r,b:t,order:o,generator:n(this,!1,a,i,null,!1),allocatePointStorage:function(){return n(this,!1,v.intToDigits(0,s),v.intToDigits(0,s))},createPointAtInfinity:function(){return n(this,!0,v.intToDigits(0,s),v.intToDigits(0,s))}}},n=function(e,t,o,a,i,s){var c;return void 0===i&&(i=null),void 0===s&&(s=!1),l(c={equals:function(e){return function(e){return!(!e||(!c.isInfinity||!e.isInfinity)&&(null===c.z&&null!==e.z||null!==c.z&&null===e.z||(null===c.z?0!==v.compareDigits(c.x,e.x)||0!==v.compareDigits(c.y,e.y)||c.isInMontgomeryForm!==e.isInMontgomeryForm:0!==v.compareDigits(c.x,e.x)||0!==v.compareDigits(c.y,e.y)||0!==v.compareDigits(c.z,e.z)||c.isInMontgomeryForm!==e.isInMontgomeryForm)))}(e)},copy:function(e){!function(e,r){if(r.curve=e.curve,r.x=e.x.slice(),r.y=e.y.slice(),null!==e.z?r.z=e.z.slice():r.z=null,u||(r.isAffine=e.isAffine),r.isInMontgomeryForm=e.isInMontgomeryForm,r.isInfinity=e.isInfinity,!r.equals(e))throw new Error("Instances should be equal.")}(this,e)},clone:function(){return e=n(c.curve,c.isInfinity,r(c.x),r(c.y),c.z?r(c.z):null,c.isInMontgomeryForm),c.ta&&(e.ta=r(c.ta)),c.tb&&(e.tb=r(c.tb)),e;var e}},"curve",e,function(){return e},function(r){e=r}),l(c,"x",o,function(){return o},function(e){o=e}),l(c,"y",a,function(){return a},function(e){a=e}),l(c,"z",i,function(){return i},function(e){i=e}),l(c,"isInMontgomeryForm",s,function(){return s},function(e){s=e}),l(c,"isInfinity",t,function(){return t},function(e){t=e}),l(c,"isAffine",null===i,function(){return null===i}),c},o=function(e){var t=1===e.type,n=e.p.length,o=v.MontgomeryMultiplier(e.p),a=e.a.slice();o.convertToMontgomeryForm(a);var s=v.isZero(e.a),c=v.One,l=r(n);l[0]=1,o.convertToMontgomeryForm(l);var f=v.IntegerGroup(v.digitsToBytes(o.m),!0),h=r(n),y=r(n),g=r(n),p=r(n),d=r(n),m=r(n),w=r(n),b=r(n),k=r(n),x=r(n),E=r(n),M=r(n);function D(e,r,t){var n=f.createElementFromInteger(0);n.m_digits=t,f.subtract(f.createElementFromDigits(e),f.createElementFromDigits(r),n)}function T(e,r,t){var n=f.createElementFromInteger(0);n.m_digits=t,f.add(f.createElementFromDigits(e),f.createElementFromDigits(r),n)}function I(r,t){var n=r.length,o=e.p;if(1==(1&r[0])){for(var a=0,i=0;i<n;i+=1)a+=r[i]+o[i],t[i]=a&v.DIGIT_MASK,a>>>=v.DIGIT_BITS;a<<=v.DIGIT_BITS-1,v.shiftRight(t,t),t[n-1]|=a}else v.shiftRight(r,t)}function A(e,r,t){o.montgomeryMultiply(e,r,t)}function K(e,r){o.montgomeryMultiply(e,e,r)}function S(e,r){var t=r.clone();if(L(t),!U(t))throw new Error("Invalid Parameter");var n=r.clone();N(n);var o,a=[r.clone()],i=n.clone(),s=n.clone();H(n,s),q(s);for(var u=1;u<Math.pow(2,e-2);u++)C(i,s,i),q(o=i.clone()),a[u]=o;return a}function H(e,r){if(void 0===e)throw new Error("point undefined");if(void 0===r)throw new Error("outputPoint undefined");if(e.isAffine)throw new Error("Given point was in Affine form. Use convertToJacobian() first.");if(!e.isInMontgomeryForm)throw new Error("Given point must be in Montgomery form. Use montgomeryize() first.");s?function(e,r){if(e.isInfinity)r.isInfinity=!0;else{K(e.y,p),K(e.x,d),T(d,d,h),T(h,d,d),A(e.x,p,m),K(p,h),I(d,y),K(y,p),A(e.y,e.z,k);for(var t=0;t<k.length;t+=1)r.z[t]=k[t];D(p,m,r.x),D(r.x,m,r.x),D(m,r.x,d),A(y,d,g),D(g,h,r.y),r.isInfinity=!1,r.isInMontgomeryForm=!0}}(e,r):function(e,r){e.isInfinity?r.isInfinity=!0:(K(e.z,y),A(e.z,e.y,d),T(e.x,y,g),D(e.x,y,y),r.z=d.slice(),A(y,g,p),I(p,g),T(p,g,y),K(e.y,g),K(y,d),A(e.x,g,p),D(d,p,d),D(d,p,r.x),D(p,r.x,d),K(g,p),A(y,d,g),D(g,p,r.y),r.isInfinity=!1,r.isInMontgomeryForm=!0)}(e,r)}function B(e,r,t){if(e.isInfinity)return r.copy(t),void this.convertToJacobianForm(t);if(r.isInfinity)e.copy(t);else{if(K(e.z,m),A(e.z,m,w),A(r.x,m,d),A(r.y,w,m),D(d,e.x,y),D(m,e.y,g),v.isZero(y))return v.isZero(g)?(H(e,t),void C(t,r,t)):(t.x=e.x.slice(0),t.y=e.y.slice(0),void(t.z=e.z.slice(0)));if(K(g,d),K(y,w),A(w,e.x,m),A(y,w,h),D(d,m,p),D(p,m,p),A(e.z,y,d),D(p,m,p),A(h,e.y,w),D(p,h,p),v.isZero(p)){for(i=0;i<t.x.length;i++)t.x[i]=0,t.y[i]=0,t.z[i]=0;t.y[0]=1}else T(w,w,y),A(d,p,t.z),A(g,p,d),K(p,h),T(y,d,y),A(h,m,d),K(y,b),A(h,p,m),D(b,d,t.x),D(t.x,d,t.x),D(t.x,m,t.x),D(t.x,d,p),A(m,w,h),A(y,p,d),D(d,h,t.y),t.isInfinity=!1,t.isInMontgomeryForm=!0}}function C(e,r,t){if(null===e)throw new Error("jacobianPoint");if(null===r)throw new Error("affinePoint");if(null===t)throw new Error("outputPoint");if(e.curve!==r.curve||e.curve!==t.curve)throw new Error("All points must be from the same curve object.");if(e.isAffine)throw new Error("Given jacobianPoint was in Affine form. Use ConvertToJacobian()                     before calling DoubleJacobianAddAffinePoints().");if(!r.isAffine)throw new Error("Given affinePoint was in Jacobian form. Use ConvertToAffine() before                      calling DoubleJacobianAddAffinePoints().");if(t.isAffine)throw new Error("Given jacobianPoint was in Jacobian form. Use ConvertToJacobian() before                      calling DoubleJacobianAddAffinePoints().");if(!e.isInMontgomeryForm)throw new Error("Jacobian point must be in Montgomery form");if(!r.isInMontgomeryForm)throw new Error("Affine point must be in Montgomery form");if(e.isInfinity)return r.copy(t),void this.convertToJacobianForm(t);if(r.isInfinity)e.copy(t);else{var o;for(K(e.z,y),A(y,e.z,g),A(y,r.x,p),A(g,r.y,d),D(p,e.x,y),D(d,e.y,g),o=0;o<y.length;o+=1)if(0!==y[o]){A(e.z,y,h);for(var a=0;a<n;a+=1)t.z[a]=h[a];return K(y,p),A(p,y,d),A(p,e.x,m),T(m,m,y),K(g,t.x),D(t.x,y,t.x),D(t.x,d,t.x),D(m,t.x,p),A(g,p,m),A(e.y,d,w),D(m,w,t.y),t.isInfinity=!1,void(t.isInMontgomeryForm=!0)}for(o=0;o<g.length;o+=1)if(0!==g[o])return t.isInfinity=!0,void(t.isInMontgomeryForm=!0);r.copy(t),this.convertToJacobianForm(t),this.double(t,t),t.isInMontgomeryForm=!0}}function P(r,t,o,a){if(t.isInfinity||v.isZero(r))o.isInfinity=!0;else{if(v.compareDigits(r,e.order)>=0)throw new Error("The scalar k must be in the range 1 <= k < order.");if(r=r.slice(),1===t.curve.type){var i=void 0!==t.ta;i||O(t),function(e,r,t,o){if(!j(r))throw new Error("Invalid Parameter");var a=r.curve.rbits;o=void 0===o||o;var i,s,u=n<=8?5:6,c=Math.floor((a+(u-2))/(u-1));e=e.slice();var l=r.clone();O(l),o&&(G(l,l),G(l,l));var f=W(1<<u-2,l),h=1&e[0],y=[];for(D(r.curve.order,e,y),i=0;i<e.length;i++)e[i]=h-1&(e[i]^y[i])^e[i];var g=v.fixedWindowRecode(e,u,c),p=Math.floor(Math.abs(g[c])-1)/2,d=f[p];for(l.x=d.x.slice(),l.y=d.y.slice(),l.z=d.z.slice(),i=c-1;i>=0;i--){for(s=0;s<u-1;s++)G(l,l);p=Math.floor((Math.abs(g[i])-1)/2);var m=R(f,p),w=-(g[i]>>>31);D(r.curve.p,m.x,y);for(var b=0;b<m.x.length;b++)m.x[b]=m.x[b]&~w|y[b]&w;for(D(r.curve.p,m.td,y),b=0;b<m.td.length;b++)m.td[b]=m.td[b]&~w|y[b]&w;J(m,l,l)}for(D(r.curve.p,l.x,y),i=0;i<l.x.length;i++)l.x[i]=h-1&(l.x[i]^y[i])^l.x[i];Z(l),t.x=l.x.slice(),t.y=l.y.slice()}(r,t,o,a),i||Z(t)}else{var s=t.isInMontgomeryForm,u=o.isInMontgomeryForm,c=o.isAffine;s||z(t),u||z(o),function(e,r,t){var o=r.clone();if(L(o),!U(o))throw new Error("Invalid Parameters.");var a=1&e[0],i=[];for(D(r.curve.order,e,i),g=0;g<e.length;g++)e[g]=a-1&(e[g]^i[g])^e[g];var s=n<=8?5:6,u=r.curve.p.length*v.DIGIT_BITS,c=Math.ceil(u/(s-1)),l=v.fixedWindowRecode(e,s,c),f=S(s,r),h=Math.floor(Math.abs(l[c])-1)/2,y=f[h].clone();N(y);for(var g=c-1;g>=0;g--){for(var p=0;p<s-2;p++)H(y,y);h=Math.floor((Math.abs(l[g])-1)/2);var d=F(f,h);D(d.curve.p,d.y,i);for(var m=-(l[g]>>>31),w=0;w<d.y.length;w++)d.y[w]=d.y[w]&~m|i[w]&m;B(y,d,y)}for(D(r.curve.p,y.y,i),g=0;g<y.y.length;g++)y.y[g]=a-1&(y.y[g]^i[g])^y.y[g];y.copy(t)}(r,t,o),c&&q(o),s||L(t),u||L(o)}}}function F(e,r){for(var t,n,o=0;o<e.length;o++)t=+(o===r),n=[n,e[o].clone()][t];return n}function z(e){if(e.isInMontgomeryForm)throw new Error("The given point is already in Montgomery form.");e.isInfinity||(o.convertToMontgomeryForm(e.x),o.convertToMontgomeryForm(e.y),null!==e.z&&o.convertToMontgomeryForm(e.z),void 0!==e.ta&&(o.convertToMontgomeryForm(e.ta),o.convertToMontgomeryForm(e.tb))),e.isInMontgomeryForm=!0}function L(e){if(!e.isInMontgomeryForm)throw new Error("The given point is not in montgomery form.");e.isInfinity||(o.convertToStandardForm(e.x),o.convertToStandardForm(e.y),null!==e.z&&o.convertToStandardForm(e.z),void 0!==e.ta&&(o.convertToStandardForm(e.ta),o.convertToStandardForm(e.tb))),e.isInMontgomeryForm=!1}function q(r){if(r.isInfinity)return r.z=null,void(u||(r.isAffine=!0));if(v.modInv(r.z,e.p,M,!0),r.isInMontgomeryForm){A(M,o.rCubedModm,E);var t=M;M=E,E=t}K(M,x),A(r.x,x,E);for(var a=0;a<n;a+=1)r.x[a]=E[a];A(r.y,x,E),A(E,M,r.y),r.z=null,delete r.ta,delete r.tb,u||(r.isAffine=!0)}function N(e){if(!e.isAffine)throw new Error("The given point is not in Affine form.");u||(e.isAffine=!1);var t,n,o=e.isInMontgomeryForm?l:c;for(t=r(o.length),n=0;n<o.length;n+=1)t[n]=o[n];e.z=t}function U(e){return!e.isInfinity&&(v.modMul(e.y,e.y,e.curve.p,y),v.modMul(e.x,e.x,e.curve.p,g),v.modMul(e.x,g,e.curve.p,p),T(p,e.curve.b,g),v.modMul(e.x,e.curve.a,e.curve.p,p),T(g,p,g),D(y,g,y),!1!==v.isZero(y))}function j(e){return e.ta&&Z(e=e.clone()),v.modMul(e.y,e.y,e.curve.p,p),v.modMul(e.x,e.x,e.curve.p,g),v.add(g,p,y),v.reduce(d,e.curve.p,d),v.modMul(g,p,e.curve.p,d),v.modMul(e.curve.d,d,e.curve.p,p),v.add(p,[1],g),v.reduce(g,e.curve.p,g),v.subtract(y,g,y),!1!==v.isZero(y)||(v.reduce(y,e.curve.p,y),!1!==v.isZero(y))}function W(e,r){var t=r.clone(),n=t.clone(),o=[];o[0]=V(r),G(t,t),n=V(t),t=r.clone();for(var a=1;a<e;a++)J(n,t,t),o[a]=V(t);return o}function O(e){e.ta=e.x.slice(),e.tb=e.y.slice(),e.z=[1]}function R(e,r){for(var t=(r+1)%e.length,n=0;n<e.length;n++){var o={x:e[t].x.slice(),y:e[t].y.slice(),z:e[t].z.slice(),td:e[t].td.slice()};t=(t+1)%e.length}return o}function Z(r){v.modInv(r.z,e.p,M,!0),v.modMul(r.x,M,e.p,r.x),v.modMul(r.y,M,e.p,r.y),delete r.ta,delete r.tb,r.z=null}function G(e,r){if(void 0===e.ta)throw new Error("Point should be in Extended Projective form.");v.modMul(e.x,e.x,e.curve.p,h),v.modMul(e.y,e.y,e.curve.p,y),v.modMul(e.z,e.z,e.curve.p,e.ta),D(y,h,r.tb),T(h,y,h),T(e.ta,e.ta,e.ta),T(e.y,e.y,e.y),D(e.ta,h,y),v.modMul(e.x,e.y,e.curve.p,r.ta),v.modMul(h,r.tb,e.curve.p,r.y),v.modMul(y,r.ta,e.curve.p,r.x),v.modMul(h,y,e.curve.p,r.z)}function V(e){var r=e.curve,t=r.p,n={x:e.x.slice(),y:e.y.slice(),z:e.z.slice(),td:[],curve:e.curve};return v.modMul(e.ta,e.tb,t,x),v.modMul(x,r.d,t,n.td),n}function J(e,r,t){var n=v,o=r.curve.p;y=[],g=[],p=[],n.modMul(r.z,e.z,o,p),n.modMul(r.ta,r.tb,o,y),T(r.x,r.y,r.ta),n.modMul(y,e.td,o,g),T(e.x,e.y,r.tb),D(p,g,y),T(p,g,p),n.modMul(r.ta,r.tb,o,g),n.modMul(r.x,e.x,o,r.z),n.modMul(r.y,e.y,o,r.x),D(g,r.z,g),D(r.x,r.z,t.ta),D(g,r.x,t.tb),n.modMul(t.ta,p,o,t.y),n.modMul(t.tb,y,o,t.x),n.modMul(p,y,o,t.z)}var Q={convertToMontgomeryForm:z,convertToStandardForm:L,convertToAffineForm:q,convertToJacobianForm:N,generatePrecomputationTable:function(e,r){return S(e,r)}};return t?(Q.double=G,Q.add=function(e,r,t){if(void 0===e.ta)throw new Error("Point1 should be in Extended Projective form.");if(void 0===r.ta)throw new Error("Point2 should be in Extended Projective form.");J(V(e),r,t)},Q.scalarMultiply=P,Q.normalize=Z,Q.convertToExtendedProjective=O,Q.convertTedToWeierstrass=function(e,r){var t=e.curve.a.slice(),n=e.curve.d.slice(),o=e.curve.p,a=v.modMul,i=v.modInv;a(t,y=[5],o,g),D(g,n,g),a(n,y,o,p),D(t,p,y),a(e.y,y,o,p),T(p,g,g),D(y=[1],e.y,p),a(y=[12],p,o,d),i(d,o,d,!0),a(e.x,p,o,y),T(y,y,p),T(p,p,p),i(p,o,p,!0),a(d,g,o,r.x),y=[1],T(e.y,y,y),D(t,n,g),a(y,g,o,d),a(d,p,o,r.y)},Q.convertWeierstrassToTed=function(e,r){var t=r.curve.a.slice(),n=r.curve.d.slice(),o=r.curve.p,a=v.modMul,i=v.modInv;T(e.x,e.x,y),T(e.x,y,y),T(y,y,y),D(y,t,g),D(g,n,g),T(e.y,e.y,p),T(e.y,p,p),T(p,p,p),i(p,o,p,!0),a(g,p,o,r.x),T(y,y,y),T(y,n,g),T(y,t,y),T(t,t,p),D(g,p,g),D(g,p,g),D(g,t,g),T(n,n,p),D(y,p,y),D(y,p,y),D(y,n,y),i(y,o,y,!0),a(y,g,o,r.y)},Q.validatePoint=j,Q.generatePrecomputationTable=function(e,r){return W(e,r)}):(Q.double=H,Q.mixedDoubleAdd=B,Q.mixedAdd=C,Q.scalarMultiply=P,Q.negate=function(e,r){e!==r&&e.copy(r),D(e.curve.p,e.y,r.y)},Q.validatePoint=U),Q},a={},s=function(r){var n=a[r.toUpperCase()];if(!n)throw new Error(r+" Unsupported curve.");if(0===n.type)return function(r){var n=new t(e(r.p),e(r.a),e(r.b),e(r.order),e(r.gx),e(r.gy));return n.type=r.type,n.name=r.name,n.generator.curve=n,n}(n);if(1===n.type)return function(r){var n=new t(e(r.p),e(r.a),e(r.d),e(r.order),e(r.gx),e(r.gy));return n.type=r.type,1===n.type&&(n.d=n.b.slice(),delete n.b),n.rbits=r.info[2],n.name=r.name,n.generator.curve=n,n}(n);throw new Error(r+" Unsupported curve type.")};return{createCurve:s,curves:a,sec1EncodingFp:function(){return{encodePoint:function(e){if(!e)throw new Error("point");if(!e.isAffine)throw new Error("Point must be in affine form.");if(e.isInMontgomeryForm)throw new Error("Point must not be in Montgomery form.");if(e.isInfinity)return r(1);var t=v.digitsToBytes(e.x),n=v.digitsToBytes(e.y),o=v.digitsToBytes(e.curve.p).length;if(o<t.length||o<n.length)throw new Error("Point coordinate(s) are bigger than the field order.");var a=r(2*o+1);a[0]=4;for(var i=o-t.length,s=0;s<t.length;s++)a[s+1+i]=t[s];for(i=o-n.length,s=0;s<n.length;s++)a[o+s+1+i]=n[s];return a},decodePoint:function(e,t){if(e.length<1)throw new Error("Byte array must have non-zero length");var o=v.digitsToBytes(t.p).length;if(0===e[0]&&1===e.length)return t.createPointAtInfinity();if(4===e[0]&&e.length===1+2*o){for(var a=r(o),i=r(o),s=0;s<o;s++)a[s]=e[s+1],i[s]=e[o+s+1];var u=v.bytesToDigits(a),c=v.bytesToDigits(i);return n(t,!1,u,c)}throw new Error("Unsupported encoding format")}}},validatePoint:function(r,t,a,i){var u=s(r),c=new n(u,!1,e(t),e(a),i&&e(i),!1);return new o(u).validatePoint(c)},EllipticCurvePointFp:n,EllipticCurveOperatorFp:o,ModularSquareRootSolver:function(e){var r=e,t=[];if(void 0===e)throw new Error("modulus");if(v.isEven(e))throw new Error("Only odd moduli are supported");var n=v.MontgomeryMultiplier(r);r[0]%4==3?(v.add(r,v.One,t),v.shiftRight(t,t,2)):t=null;var o=new Array(r.length),a=new Array(r.length);return{squareRoot:function(e){if(null!==t)return function(e){var r=v.intToDigits(0,16);n.modExp(e,t,r);var o=[0];return v.modMul(r,r,n.m,o),0!==v.compareDigits(e,o)?null:r}(e);throw new Error("GeneralCase not supported.")},jacobiSymbol:function(e){var t,n;t=e.slice(),n=r.slice(),v.reduce(t,n,t,o,a);for(var i=1;!v.isZero(t);){for(;v.isEven(t);){v.shiftRight(t,t);var s=7&n[0];3!==s&&5!==s||(i=-i)}var u=t;t=n,n=u;var c=3&t[0],l=3&n[0];3===c&&3===l&&(i=-i),v.reduce(t,n,t,o,a)}return 0===v.compareDigits(n,v.One)?i:0}}}}}();void 0!==m&&(m.curves["P-256"]={name:"P-256",type:0,p:[255,255,255,255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255],a:[255,255,255,255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,252],b:[90,198,53,216,170,58,147,231,179,235,189,85,118,152,134,188,101,29,6,176,204,83,176,246,59,206,60,62,39,210,96,75],order:[255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81],gx:[107,23,209,242,225,44,66,71,248,188,230,229,99,164,64,242,119,3,125,129,45,235,51,160,244,161,57,69,216,152,194,150],gy:[79,227,66,226,254,26,127,155,142,231,235,74,124,15,158,22,43,206,51,87,107,49,94,206,203,182,64,104,55,191,81,245],cf:1},m.curves["P-384"]={name:"P-384",type:0,p:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,255],a:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,255,255,0,0,0,0,0,0,0,0,255,255,255,252],b:[179,49,47,167,226,62,231,228,152,142,5,107,227,248,45,25,24,29,156,110,254,129,65,18,3,20,8,143,80,19,135,90,198,86,57,141,138,46,209,157,42,133,200,237,211,236,42,239],order:[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115],gx:[170,135,202,34,190,139,5,55,142,177,199,30,243,32,173,116,110,29,59,98,139,167,155,152,89,247,65,224,130,84,42,56,85,2,242,93,191,85,41,108,58,84,94,56,114,118,10,183],gy:[54,23,222,74,150,38,44,111,93,158,152,191,146,146,220,41,248,244,29,189,40,154,20,124,233,218,49,19,181,240,184,192,10,96,177,206,29,126,129,157,122,67,29,124,144,234,14,95],cf:1},m.curves["P-521"]={name:"P-521",type:0,p:[1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],a:[1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,252],b:[0,81,149,62,185,97,142,28,154,31,146,154,33,160,182,133,64,238,162,218,114,91,153,179,21,243,184,180,137,145,142,241,9,225,86,25,57,81,236,126,147,123,22,82,192,189,59,177,191,7,53,115,223,136,61,44,52,241,239,69,31,212,107,80,63,0],order:[1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9],gx:[0,198,133,142,6,183,4,4,233,205,158,62,203,102,35,149,180,66,156,100,129,57,5,63,181,33,248,40,175,96,107,77,61,186,161,75,94,119,239,231,89,40,254,29,193,39,162,255,168,222,51,72,179,193,133,106,66,155,249,126,126,49,194,229,189,102],gy:[1,24,57,41,106,120,154,59,192,4,92,138,95,180,44,125,27,217,152,245,68,73,87,155,68,104,23,175,189,23,39,62,102,44,151,238,114,153,94,244,38,64,197,80,185,1,63,173,7,97,53,60,112,134,162,114,194,64,136,190,148,118,159,209,102,80],cf:1});void 0!==m&&(m.curves["BN-254"]={name:"BN-254",type:0,p:[37,35,100,130,64,0,0,1,186,52,77,128,0,0,0,8,97,33,0,0,0,0,0,19,167,0,0,0,0,0,0,19],a:[0],b:[2],order:[37,35,100,130,64,0,0,1,186,52,77,128,0,0,0,7,255,159,128,0,0,0,0,16,161,0,0,0,0,0,0,13],gx:[37,35,100,130,64,0,0,1,186,52,77,128,0,0,0,8,97,33,0,0,0,0,0,19,167,0,0,0,0,0,0,18],gy:[1],cf:1});var w={info:["numsp256d1",256,256,256],type:0,p:[67,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[64,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),b:[129,85,2].reverse(),order:[37,168,81,71,41,32,171,32,96,92,38,234,117,130,60,228,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),gx:[177,172,26,178,30,238,82,188,58,199,212,3,9,155,87,131,9,203,66,79,160,149,122,41,97,219,170,90,182,214,158,188].reverse(),gy:[159,222,132,33,203,185,181,128,187,15,49,21,209,195,85,201,53,224,4,126,247,139,68,115,166,182,153,51,241,192,143,208].reverse(),cf:1},b={info:["numsp256t1",256,255,256],name:"numsp256t1",type:1,p:[67,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[1],d:[85,195,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[245,74,221,238,144,177,71,26,155,67,89,47,165,90,149,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64].reverse(),gx:[218,19,237,46,144,192,222,160,134,53,8,227,14,138,57,12,214,155,32,105,95,61,30,205,125,35,234,106,251,20,117,138].reverse(),gy:[230,137,138,121,231,22,166,47,211,110,133,16,216,97,95,113,16,128,75,166,217,101,150,206,199,37,217,217,159,62,213,68].reverse(),cf:4},k={info:["numsp384d1",384,384,384],name:"numsp384d1",type:0,p:[195,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[192,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),b:[187,119,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[185,97,14,123,246,129,77,96,122,226,55,76,61,157,218,190,129,104,93,235,30,175,30,214,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),gx:[42,21,152,32,4,186,156,235,123,196,97,15,16,237,46,82,66,199,108,42,27,41,189,243,244,249,129,251,205,193,37,2,166,241,5,65,34,202,128,72,28,24,111,177,240,86,121,117].reverse(),gy:[22,7,24,102,236,184,116,92,38,173,244,191,219,180,214,188,126,131,26,18,125,131,32,185,156,115,127,248,119,105,4,176,126,207,132,5,48,61,227,215,56,142,155,225,104,227,222,172].reverse(),cf:1},x={info:["numsp384t1",384,382,384],name:"numsp384t1",type:1,p:[195,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[1],d:[159,209,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[125,137,163,230,196,220,185,32,121,200,53,171,90,85,228,97,207,225,107,180,28,26,71,226,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,63].reverse(),gx:[222,107,32,108,228,64,213,80,19,148,69,101,177,146,242,111,64,99,49,243,168,255,99,87,0,76,190,229,70,244,11,179,181,93,229,154,18,162,182,192,108,38,169,69,251,17,177,97].reverse(),gy:[146,147,114,240,225,3,141,157,220,72,236,70,249,176,114,0,75,150,69,246,247,152,15,131,86,95,66,241,116,130,173,22,215,13,177,35,164,177,56,135,176,238,166,185,103,62,152,130].reverse(),cf:4},E={info:["numsp512d1",512,512,512],name:"numsp512d1",type:0,p:[199,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[196,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),b:[155,217,1].reverse(),order:[93,85,51,4,57,63,21,206,67,210,124,96,54,139,86,59,198,189,208,151,237,88,194,79,27,131,231,148,251,164,60,91,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),gx:[87,174,171,140,149,135,130,220,226,93,111,125,19,96,93,29,131,21,86,37,134,66,121,147,158,53,107,7,81,161,33,80,249,217,6,83,194,224,6,69,133,246,1,181,59,216,202,152,82,59,61,160,2,112,43,218,147,10,29,20,71,52,192,58].reverse(),gy:[166,39,53,56,96,135,160,35,233,15,253,76,30,92,43,207,2,86,90,178,64,168,33,193,233,237,14,139,218,21,132,162,20,79,209,123,12,38,75,143,140,187,188,171,222,219,151,75,0,177,235,99,220,238,14,206,179,86,173,41,202,84,58,148].reverse(),cf:4},M={info:["numsp512t1",512,510,512],name:"numsp512t1",type:1,p:[199,253,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),a:[1].reverse(),d:[239,203,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255].reverse(),order:[109,212,238,27,245,140,70,103,255,236,239,109,120,5,70,42,245,134,182,112,201,216,63,158,186,145,207,47,109,99,240,180,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,63].reverse(),gx:[254,87,236,153,41,171,185,197,21,240,196,124,66,37,229,15,173,4,137,86,146,201,189,120,15,115,70,238,78,193,33,70,71,129,59,39,190,126,161,39,130,163,196,77,159,231,209,47,51,197,211,136,120,203,24,122,156,182,141,18,109,49,142,223].reverse(),gy:[225,245,226,193,192,222,109,50,31,208,241,155,138,211,102,2,253,193,236,42,134,6,26,96,98,53,150,233,242,83,202,32,65,131,158,144,149,107,43,169,34,157,37,216,38,247,118,228,110,37,42,168,119,245,176,152,113,202,73,157,243,191,9,109].reverse(),cf:4};void 0!==m&&(m.curves.NUMSP256D1=w,m.curves.NUMSP384D1=k,m.curves.NUMSP512D1=E,m.curves.NUMSP256T1=b,m.curves.NUMSP384T1=x,m.curves.NUMSP512T1=M);var D=function(e,r,t,n,o,a,i){var s=h,u=t.slice(),c=new Array(o),l=[],f=0;function y(e){for(var r=Math.floor(e.length/o),t=0;t<r;t++)a(e,t,u,n,c);return f+=r,e.slice(r*o)}function g(){if(0!==y(function(e){var r=o-e.length%o;r<=o/8&&(r+=o);var t=s.getVector(r);t[0]=128;for(var n=8*(e.length+f*o),a=1;a<=8;a++)t[r-a]=n%256,n=Math.floor(n/256);return e.concat(t)}(l)).length)throw new Error("buffer.length !== 0");var e=function(){for(var e=[],r=0;r<u.length;r++)e=e.concat(s.int32ToBytes(u[r]));return e.length=i/8,e}();return l=[],u=t.slice(),f=0,e}return{name:e,computeHash:function(e){return l=y(e),g()},process:function(e){(l=l.concat(e)).length>=o&&(l=y(l))},finish:g,der:r,hashLen:i,maxMessageSize:4294967295}},T=function(){function e(e,t,n,o,a){var i,s,u,c,l=4294967295,f=n[0],h=n[1],y=n[2],g=n[3],p=n[4];for(s=0;s<16;s++)a[s]=r.bytesToInt32(e,64*t+4*s);for(i=16;i<80;i++)c=a[i-3]^a[i-8]^a[i-14]^a[i-16],a[i]=c<<1|c>>>31;for(s=0;s<80;s++)u=f<<5|f>>>27,u+=s>=60?h^y^g:s>=40?h&y^h&g^y&g:s>=20?h^y^g:h&y^~h&g,u+=p+o[s]+a[s],p=g,g=y,y=h<<30|h>>>2,h=f,f=u;return n[0]+=f&l,n[1]+=h&l,n[2]+=y&l,n[3]+=g&l,n[4]+=p&l,n}var r=h,t=r.unpackData,n=t("Z0UjAe/Nq4mYutz+EDJUdsPS4fA=",4,1),o=t("WoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlagnmZWoJ5mVqCeZlu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroW7Z66Fu2euhbtnroY8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcjxu83I8bvNyPG7zcymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdbKYsHWymLB1spiwdY",4,1),a=t("MCEwCQYFKw4DAhoFAAQU");return{sha1:function(){return D("SHA-1",a,n,o,64,e,160)}}}();void 0!==r&&(T.instances={},T.getInstance=function(e){return T.instances[e]||(T.instances[e]=T.sha1())},T.deleteInstance=function(e){T.instances[e]=null,delete T.instances[e]},T.hash=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?T.sha1.finish():T.sha1().computeHash(e.buffer);T.sha1.process(e.buffer)},r.register("digest","sha-1",T.hash)),f["sha-1"]=T.sha1;var I=function(){var e=h;function r(r,t,n,o,a){var i,s,u,c,l,f=n[0],h=n[1],y=n[2],g=n[3],p=n[4],d=n[5],v=n[6],m=n[7];for(s=0;s<16;s++)a[s]=e.bytesToInt32(r,64*t+4*s);for(i=16;i<64;i++)c=a[i-15],l=a[i-2],a[i]=((l>>>17|l<<15)^(l>>>19|l<<13)^l>>>10)+a[i-7]+((c>>>7|c<<25)^(c>>>18|c<<14)^c>>>3)+a[i-16],a[i]=4294967295&a[i];for(s=0;s<64;s++)g+=u=m+((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&d^~p&v)+o[s]+a[s],u+=((f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10))+(f&(h^y)^h&y),m=v,v=d,d=p,p=g,g=y,y=h,h=f,f=u;return n[0]=n[0]+f>>>0,n[1]=n[1]+h>>>0,n[2]=n[2]+y>>>0,n[3]=n[3]+g>>>0,n[4]=n[4]+p>>>0,n[5]=n[5]+d>>>0,n[6]=n[6]+v>>>0,n[7]=n[7]+m>>>0,n}var t,n,o,a,i,s=e.unpackData;return n=s("wQWe2DZ81QcwcN0X9w5ZOf/ACzFoWBURZPmPp776T6Q",4,1),o=s("agnmZ7tnroU8bvNypU/1OlEOUn+bBWiMH4PZq1vgzRk",4,1),t=s("QoovmHE3RJG1wPvP6bXbpTlWwltZ8RHxkj+CpKscXtXYB6qYEoNbASQxhb5VDH3Dcr5ddIDesf6b3AanwZvxdOSbacHvvkeGD8GdxiQMocwt6SxvSnSEqlywqdx2+YjamD5RUqgxxm2wAyfIv1l/x8bgC/PVp5FHBspjURQpKWcntwqFLhshOE0sbfxTOA0TZQpzVHZqCruBwskuknIshaK/6KGoGmZLwkuLcMdsUaPRkugZ1pkGJPQONYUQaqBwGaTBFh43bAgnSHdMNLC8tTkcDLNO2KpKW5zKT2gub/N0j4LueKVjb4TIeBSMxwIIkL7/+qRQbOu++aP3xnF48g",4,1),a=s("MC0wDQYJYIZIAWUDBAIEBQAEHA"),i=s("MDEwDQYJYIZIAWUDBAIBBQAEIA"),{sha224:function(){return D("SHA-224",a,n,t,64,r,224)},sha256:function(){return D("SHA-256",i,o,t,64,r,256)}}}();void 0!==r&&(I.instance224=I.instance224||I.sha224(),I.instance256=I.instance256||I.sha256(),I.instances={},I.getInstance224=function(e){return I.instances[e]||(I.instances[e]=I.sha224())},I.getInstance256=function(e){return I.instances[e]||(I.instances[e]=I.sha256())},I.deleteInstance=function(e){I.instances[e]=null,delete I.instances[e]},I.hash256=function(e){if("process"===e.operationSubType)return I.getInstance256(e.workerid).process(e.buffer),null;if("finish"===e.operationSubType){var r=I.getInstance256(e.workerid).finish();return I.deleteInstance(e.workerid),r}if("abort"!==e.operationSubType)return I.instance256.computeHash(e.buffer);I.deleteInstance(e.workerid)},I.hash224=function(e){if("process"!==e.operationSubType){if("finish"===e.operationSubType&&I.getInstance224(e.workerid).finish(),"abort"!==e.operationSubType)return I.instance224.computeHash(e.buffer);msrcryptoSha224.deleteInstance(e.workerid)}else I.getInstance224(e.workerid).process(e.buffer)},r.register("digest","sha-224",I.hash224),r.register("digest","sha-256",I.hash256)),f["sha-224"]=I.sha224,f["sha-256"]=I.sha256;var A=function(){function e(e,r,t,n,o){var a=r+n|0,i=a>>>0<n>>>0;o[0]=e+t+i|0,o[1]=a}function r(r,t,n,o,a){var i,s,u,c,l,f,h,y,g,p=[],d=[],v=[],m=n[0],w=n[1],b=n[2],k=n[3],x=n[4],E=n[5],M=n[6],D=n[7],T=n[8],I=n[9],A=n[10],K=n[11],S=n[12],H=n[13],B=n[14],C=n[15];for(i=0;i<32;i++)g=128*t+4*i,a[i]=r.slice(g,g+4),a[i]=a[i][0]<<24|a[i][1]<<16|a[i][2]<<8|a[i][3];for(i=32;i<160;i+=2)u=((h=a[i-30])>>>1|(y=a[i-29])<<31)^(h>>>8|y<<24)^h>>>7,c=(y>>>1|h<<31)^(y>>>8|h<<24)^(y>>>7|h<<25),e(l=((h=a[i-4])>>>19|(y=a[i-3])<<13)^(y>>>29|h<<3)^h>>>6,f=(y>>>19|h<<13)^(h>>>29|y<<3)^(y>>>6|h<<26),a[i-14],a[i-13],p),e(u,c,p[0],p[1],p),e(a[i-32],a[i-31],p[0],p[1],p),a[i]=p[0],a[i+1]=p[1];for(s=0;s<160;s+=2)l=T&A^S&~T,f=I&K^H&~I,e(B,C,u=(T>>>14|I<<18)^(T>>>18|I<<14)^(I>>>9|T<<23),c=(I>>>14|T<<18)^(I>>>18|T<<14)^(T>>>9|I<<23),p),e(l,f,o[s],o[s+1],d),e(p[0],p[1],a[s],a[s+1],v),e(d[0],d[1],v[0],v[1],v),e(v[0],v[1],M,D,p),M=p[0],D=p[1],f=w&(k^E)^k&E,l=m&(b^x)^b&x,e(v[0],v[1],u=(m>>>28|w<<4)^(w>>>2|m<<30)^(w>>>7|m<<25),c=(w>>>28|m<<4)^(m>>>2|w<<30)^(m>>>7|w<<25),p),e(l,f,u=p[0],c=p[1],p),B=S,C=H,S=A,H=K,A=T,K=I,T=M,I=D,M=x,D=E,x=b,E=k,b=m,k=w,m=u=p[0],w=c=p[1];return e(n[0],n[1],m,w,p),n[0]=p[0],n[1]=p[1],e(n[2],n[3],b,k,p),n[2]=p[0],n[3]=p[1],e(n[4],n[5],x,E,p),n[4]=p[0],n[5]=p[1],e(n[6],n[7],M,D,p),n[6]=p[0],n[7]=p[1],e(n[8],n[9],T,I,p),n[8]=p[0],n[9]=p[1],e(n[10],n[11],A,K,p),n[10]=p[0],n[11]=p[1],e(n[12],n[13],S,H,p),n[12]=p[0],n[13]=p[1],e(n[14],n[15],B,C,p),n[14]=p[0],n[15]=p[1],n}var t,n,o,a,i,s,u,c=h.unpackData;return t=c("y7udXcEFnthimikqNnzVB5FZAVowcN0XFS/s2PcOWTlnMyZn/8ALMY60SodoWBUR2wwuDWT5j6dHtUgdvvpPpA==",4,1),n=c("agnmZ/O8yQi7Z66FhMqnOzxu83L+lPgrpU/1Ol8dNvFRDlJ/reaC0ZsFaIwrPmwfH4PZq/tBvWtb4M0ZE34heQ",4,1),o=c("QoovmNcoriJxN0SRI+9lzbXA+8/sTTsv6bXbpYGJ27w5VsJb80i1OFnxEfG2BdAZkj+CpK8ZT5urHF7V2m2BGNgHqpijAwJCEoNbAUVwb74kMYW+TuSyjFUMfcPV/7Ticr5ddPJ7iW+A3rH+OxaWsZvcBqclxxI1wZvxdM9pJpTkm2nBnvFK0u++R4Y4TyXjD8GdxouM1bUkDKHMd6ycZS3pLG9ZKwJ1SnSEqm6m5INcsKncvUH71Hb5iNqDEVO1mD5RUu5m36uoMcZtLbQyELADJ8iY+yE/v1l/x77vDuTG4AvzPaiPwtWnkUeTCqclBspjUeADgm8UKSlnCg5ucCe3CoVG0i/8LhshOFwmySZNLG38WsQq7VM4DROdlbPfZQpzVIuvY952agq7PHeyqIHCyS5H7a7mknIshRSCNTuiv+ihTPEDZKgaZku8QjABwkuLcND4l5HHbFGjBlS+MNGS6BnW71IY1pkGJFVlqRD0DjWFV3EgKhBqoHAyu9G4GaTBFrjS0MgeN2wIUUGrUydId0zfjuuZNLC8teGbSKg5HAyzxclaY07YqkrjQYrLW5zKT3dj43NoLm/z1rK4o3SPgu5d77L8eKVjb0MXL2CEyHgUofCrcozHAggaZDnskL7/+iNjHiikUGzr3oK96b75o/eyxnkVxnF48uNyUyvKJz7O6iZhnNGGuMchwMIH6tp91s3g6x71fU9/7m7ReAbwZ6pyF2+6CmN9xaLImKYRP5gEvvkNrhtxCzUTHEcbKNt39SMEfYQyyqt7QMckkzyevgoVyb68Qx1nxJwQDUxMxdS+yz5Ctll/KZz8ZX4qX8tvqzrW+uxsRBmMSkdYFw==",4,1),a=c("MEEwDQYJYIZIAWUDBAICBQAEMA"),i=c("MFEwDQYJYIZIAWUDBAIDBQAEQA"),s=c("MC0wDQYJYIZIAWUDBAIFBQAEHA"),u=c("MDEwDQYJYIZIAWUDBAIGBQAEIA"),{sha384:function(){return D("SHA-384",a,t,o,128,r,384)},sha512:function(){return D("SHA-512",i,n,o,128,r,512)},sha512_224:function(){return D("SHA-512.224",s,n,o,128,r,224)},sha512_256:function(){return D("SHA-512.256",u,n,o,128,r,256)}}}();void 0!==r&&(A.instances={},A.getInstance384=function(e){return A.instances[e]||(A.instances[e]=A.sha384())},A.getInstance512=function(e){return A.instances[e]||(A.instances[e]=A.sha512())},A.deleteInstance=function(e){A.instances[e]=null,delete A.instances[e]},A.hash384=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?A.sha384.finish():A.sha384().computeHash(e.buffer);A.sha384.process(e.buffer)},A.hash512=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?A.sha512.finish():A.sha512().computeHash(e.buffer);A.sha512.process(e.buffer)},r.register("digest","sha-384",A.hash384),r.register("digest","sha-512",A.hash512)),f["sha-384"]=A.sha384,f["sha-512"]=A.sha512;var K=function(e,r){var t,n,o,a,i,s={384:128,512:128}[r.name.replace(/SHA-/,"")]||64,u=e.length===s?e:e.length>s?l(r.computeHash(e),s):l(e,s);function c(e,r){for(var t=new Array(e),n=0;n<e.length;n++)t[n]=e[n]^r[n];return t}function l(e,r){for(var t=e.slice(),n=e.length;n<r;n++)t.push(0);return t}function f(e){i?r.process(e):(i=a.concat(e),r.process(i))}function h(){var e=r.finish(),t=o.concat(e);return r.computeHash(t)}function y(){e=null,r=null,u=null}t=new Array(s),n=new Array(s);for(var g=0;g<s;g++)t[g]=54,n[g]=92;return a=c(u,t),o=c(u,n),{computeHmac:function(e,r,t){f(e);var n=h();return y(),n},process:function(e,r,t){return f(e),null},finish:function(e,r){var t=h();return y(),t}}};if(void 0!==r){var S={};K.signHmac=function(e){var r,t=e.keyHandle.algorithm.hash.name.toLowerCase(),n=f[t](),o=e.workerid;return S[o]||(S[o]=K(e.keyData,n)),"process"===e.operationSubType?(S[o].process(e.buffer),null):"finish"===e.operationSubType?(r=S[o].finish(),S[o]=null,r):(r=S[o].computeHmac(e.buffer),S[o]=null,r)},K.verifyHmac=function(e){var r,t=e.keyHandle.algorithm.hash.name.toLowerCase(),n=f[t](),o=e.workerid;return S[o]||(S[o]=K(e.keyData,n)),"process"===e.operationSubType?(S[o].process(e.buffer),null):"finish"===e.operationSubType?(r=S[o].finish(),r=h.arraysEqual(r,e.signature),S[o]=null,r):(r=S[o].computeHmac(e.buffer),r=h.arraysEqual(r,e.signature),S[o]=null,r)},K.generateKey=function(e){var r=e.algorithm.length;return r||(r={"sha-1":64,"sha-224":64,"sha-256":64,"sha-384":128,"sha-512":128}[e.algorithm.hash.name.toLowerCase()]),{type:"keyGeneration",keyData:J.getBytes(r),keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:"secret"}}},K.importKey=function(e){var r;if(e.keyData.length,"jwk"===e.format)(r=d.jwkToKey(e.keyData,e.algorithm,["k"])).alg=r.alg.replace("HS","SHA-");else{if("raw"!==e.format)throw new Error("unsupported import format");r={k:h.toArray(e.keyData)}}return{type:"keyImport",keyData:r.k,keyHandle:{algorithm:{name:"HMAC",hash:{name:e.algorithm.hash.name}},extractable:e.extractable||r.extractable,usages:e.usages,type:"secret"}}},K.exportKey=function(e){if("jwk"===e.format)return{type:"keyExport",keyHandle:d.keyToJwk(e.keyHandle,e.keyData)};if("raw"===e.format)return{type:"keyExport",keyHandle:e.keyData};throw new Error("unsupported export format")},r.register("importKey","hmac",K.importKey),r.register("exportKey","hmac",K.exportKey),r.register("generateKey","hmac",K.generateKey),r.register("sign","hmac",K.signHmac),r.register("verify","hmac",K.verifyHmac)}var H,B,C,P,F,z,L,q,N,U,j={aes:function(e){var r,t,n,o;switch(H||(H=h.unpackData("AAIEBggKDA4QEhQWGBocHiAiJCYoKiwuMDI0Njg6PD5AQkRGSEpMTlBSVFZYWlxeYGJkZmhqbG5wcnR2eHp8foCChIaIioyOkJKUlpianJ6goqSmqKqsrrCytLa4ury+wMLExsjKzM7Q0tTW2Nrc3uDi5Obo6uzu8PL09vj6/P4bGR8dExEXFQsJDw0DAQcFOzk/PTMxNzUrKS8tIyEnJVtZX11TUVdVS0lPTUNBR0V7eX99c3F3dWtpb21jYWdlm5mfnZORl5WLiY+Ng4GHhbu5v72zsbe1q6mvraOhp6Xb2d/d09HX1cvJz83DwcfF+/n//fPx9/Xr6e/t4+Hn5QADBgUMDwoJGBseHRQXEhEwMzY1PD86OSgrLi0kJyIhYGNmZWxvaml4e359dHdycVBTVlVcX1pZSEtOTURHQkHAw8bFzM/Kydjb3t3U19LR8PP29fz/+vno6+7t5Ofi4aCjpqWsr6qpuLu+vbS3srGQk5aVnJ+amYiLjo2Eh4KBm5idnpeUkZKDgIWGj4yJiquora6npKGis7C1tr+8ubr7+P3+9/Tx8uPg5ebv7Onqy8jNzsfEwcLT0NXW39zZ2ltYXV5XVFFSQ0BFRk9MSUpraG1uZ2RhYnNwdXZ/fHl6Ozg9Pjc0MTIjICUmLywpKgsIDQ4HBAECExAVFh8cGRoADhwSODYkKnB+bGJIRlRa4O788tjWxMqQnoyCqKa0utvVx8nj7f/xq6W3uZOdj4E7NScpAw0fEUtFV1lzfW9hraOxv5WbiYfd08HP5ev5901DUV91e2lnPTMhLwULGRd2eGpkTkBSXAYIGhQ+MCIslpiKhK6gsrzm6Pr03tDCzEFPXVN5d2VrMT8tIwkHFRuhr72zmZeFi9HfzcPp5/X7mpSGiKKsvrDq5Pb40tzOwHp0ZmhCTF5QCgQWGDI8LiDs4vD+1NrIxpySgI6kqri2DAIQHjQ6KCZ8cmBuREpYVjc5KyUPARMdR0lbVX9xY23X2cvF7+Hz/aepu7WfkYONAA0aFzQ5LiNoZXJ/XFFGS9Ddysfk6f7zuLWir4yBlpu7tqGsj4KVmNPeycTn6v3wa2ZxfF9SRUgDDhkUNzotIG1gd3pZVENOBQgfEjE8Kya9sKeqiYSTntXYz8Lh7Pv21tvMweLv+PW+s6SpioeQnQYLHBEyPyglbmN0eVpXQE3a18DN7uP0+bK/qKWGi5yRCgcQHT4zJClib3h1VltMQWFse3ZVWE9CCQQTHj0wJyqxvKumhYifktnUw87t4Pf6t7qtoIOOmZTf0sXI6+bx/GdqfXBTXklEDwIVGDs2ISwMARYbODUiL2RpfnNQXUpH3NHGy+jl8v+0ua6jgI2alwALFh0sJzoxWFNORXR/Ymmwu6atnJeKgejj/vXEz9LZe3BtZldcQUojKDU+DwQZEsvA3dbn7PH6k5iFjr+0qaL2/eDr2tHMx66luLOCiZSfRk1QW2phfHceFQgDMjkkL42Gm5Chqre81d7DyPny7+Q9NisgERoHDGVuc3hJQl9U9/zh6tvQzcavpLmyg4iVnkdMUVprYH12HxQJAjM4JS6Mh5qRoKu2vdTfwsn48+7lPDcqIRAbBg1kb3J5SENeVQEKFxwtJjswWVJPRHV+Y2ixuqesnZaLgOni//TFztPYenFsZ1ZdQEsiKTQ/DgUYE8rB3Nfm7fD7kpmEj761qKMACRIbJC02P0hBWlNsZX53kJmCi7S9pq/Y0crD/PXu5zsyKSAfFg0Ec3phaFdeRUyrormwj4adlOPq8fjHztXcdn9kbVJbQEk+NywlGhMIAebv9P3Cy9DZrqe8tYqDmJFNRF9WaWB7cgUMFx4hKDM63dTPxvnw6+KVnIeOsbijquzl/vfIwdrTpK22v4CJkpt8dW5nWFFKQzQ9Ji8QGQIL197FzPP64eiflo2Eu7KpoEdOVVxjanF4DwYdFCsiOTCak4iBvrespdLbwMn2/+TtCgMYES4nPDVCS1BZZm90faGos7qFjJee6eD78s3E39YxOCMqFRwHDnlwa2JdVE9GY3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7FlIJatUwNqU4v0CjnoHz1/t84zmCmy//hzSOQ0TE3unLVHuUMqbCIz3uTJULQvrDTgguoWYo2SSydluiSW2L0SVy+PZkhmiYFtSkXMxdZbaSbHBIUP3tudpeFUZXp42dhJDYqwCMvNMK9+RYBbizRQbQLB6Pyj8PAsGvvQMBE4prOpERQU9n3OqX8s/O8LTmc5asdCLnrTWF4vk36Bx1325H8RpxHSnFiW+3Yg6qGL4b/FY+S8bSeSCa28D+eM1a9B/dqDOIB8cxsRIQWSeA7F9gUX+pGbVKDS3lep+TyZzvoOA7Ta4q9bDI67s8g1OZYRcrBH66d9Ym4WkUY1UhDH2NAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuN",256,!1),B=H[0],C=H[1],P=H[2],F=H[3],z=H[4],L=H[5],q=H[6],N=H[7],U=H[8]),r=8*e.length){case 128:case 192:case 256:break;default:throw new Error("Unsupported keyLength")}n=6+(t=r/32);var a=function(e){var r=e[1];e[1]=e[5],e[5]=e[9],e[9]=e[13],e[13]=r,r=e[2],e[2]=e[10],e[10]=r,r=e[6],e[6]=e[14],e[14]=r,r=e[15],e[15]=e[11],e[11]=e[7],e[7]=e[3],e[3]=r},i=function(e){var r=e[13];e[13]=e[9],e[9]=e[5],e[5]=e[1],e[1]=r,r=e[10],e[10]=e[2],e[2]=r,r=e[14],e[14]=e[6],e[6]=r,r=e[3],e[3]=e[7],e[7]=e[11],e[11]=e[15],e[15]=r},s=function(e){var r=e[0],t=e[1],n=e[2],o=e[3],a=e[4],i=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11],y=e[12],g=e[13],p=e[14],d=e[15];e[0]=B[r]^C[t]^n^o,e[1]=r^B[t]^C[n]^o,e[2]=r^t^B[n]^C[o],e[3]=C[r]^t^n^B[o],e[4]=B[a]^C[i]^s^u,e[5]=a^B[i]^C[s]^u,e[6]=a^i^B[s]^C[u],e[7]=C[a]^i^s^B[u],e[8]=B[c]^C[l]^f^h,e[9]=c^B[l]^C[f]^h,e[10]=c^l^B[f]^C[h],e[11]=C[c]^l^f^B[h],e[12]=B[y]^C[g]^p^d,e[13]=y^B[g]^C[p]^d,e[14]=y^g^B[p]^C[d],e[15]=C[y]^g^p^B[d]},u=function(e){var r=e[0],t=e[1],n=e[2],o=e[3],a=e[4],i=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11],y=e[12],g=e[13],p=e[14],d=e[15];e[0]=P[r]^z[t]^F[n]^L[o],e[1]=L[r]^P[t]^z[n]^F[o],e[2]=F[r]^L[t]^P[n]^z[o],e[3]=z[r]^F[t]^L[n]^P[o],e[4]=P[a]^z[i]^F[s]^L[u],e[5]=L[a]^P[i]^z[s]^F[u],e[6]=F[a]^L[i]^P[s]^z[u],e[7]=z[a]^F[i]^L[s]^P[u],e[8]=P[c]^z[l]^F[f]^L[h],e[9]=L[c]^P[l]^z[f]^F[h],e[10]=F[c]^L[l]^P[f]^z[h],e[11]=z[c]^F[l]^L[f]^P[h],e[12]=P[y]^z[g]^F[p]^L[d],e[13]=L[y]^P[g]^z[p]^F[d],e[14]=F[y]^L[g]^P[p]^z[d],e[15]=z[y]^F[g]^L[p]^P[d]},c=function(e,r){return[e[0]^r[0],e[1]^r[1],e[2]^r[2],e[3]^r[3]]},l=function(e,r,t){for(var n=0;n<e.length;n+=1)e[n]^=r[n+t]},f=function(e){for(var r=0;r<e.length;r+=1)e[r]=q[e[r]]},y=function(e){for(var r=0;r<e.length;r+=1)e[r]=N[e[r]]},g=function(e,r){return[e[4*r],e[4*r+1],e[4*r+2],e[4*r+3]]};return o=function(e){for(var r,o,a,i,s,u,l,h=[],y=0;y<4*t;)h.push(e[y++]);for(y=t;y<4*(n+1);){if(r=g(h,y-1),y%t==0){var p=[U[y/t],0,0,0];l=void 0,l=(u=r)[0],u[0]=u[1],u[1]=u[2],u[2]=u[3],u[3]=l,f(r),r=c(r,p)}else t>6&&y%t==4&&f(r);var d=c(g(h,y-t),r);a=d,s=0,(o=h)[4*(i=y)]=a[4*s],o[4*i+1]=a[4*s+1],o[4*i+2]=a[4*s+2],o[4*i+3]=a[4*s+3],y+=1}return h}(e),{encrypt:function(e){var r,t=e;for(l(t,o,0),r=1;r<=n-1;r+=1)f(t),a(t),s(t),l(t,o,4*r*4);return f(t),a(t),l(t,o,4*n*4),t},decrypt:function(e){var r,t=e;for(l(t,o,4*n*4),r=n-1;r>=1;r-=1)i(t),y(t),l(t,o,4*r*4),u(t);return i(t),y(t),l(t,o,0),t},clear:function(){},keyLength:r,blockSize:128}}},W=W||{};W.pkcsv7=function(e){return{pad:function(r){var t=r[r.length-1>=0?r.length-1:0],n=t.length;if(n===e){var o,a=[];for(o=0;o<e;o+=1)a.push(e);r.push(a)}else for(var i=e-n&255;t.length!==e;)t.push(i)},unpad:function(r){var t=!0;r.length%e!=0&&(t=!1);for(var n=r.slice(-e),o=n[n.length-1],a=0;a<e;a++){var i=e-a<=o,s=n[a]===o;t=(!i||s)&&t}var u=t?o:0;return r.length-=u,t}}};var O=function(e){var r=e.blockSize/8,t=W.pkcsv7(r),n=function(e){var r,t,n=[];for(r=0;r<e.length;r+=1){var o=e[r];for(t=0;t<o.length;t+=1)n.push(o[t])}return n};function o(e){var t=[];u=u.concat(e);for(var n=Math.floor(u.length/r),o=0;o<n;o++)t.push(u.slice(o*r,(o+1)*r));return u=u.slice(n*r),t}function a(r){for(var t,n=[],o=0;o<r.length;o++)t=h.xorVectors(s,r[o]),n.push(e.encrypt(t)),s=n[o];return n}function i(){u=[],c=[],s=null}var s,u=[],c=[];return{init:function(e){if(e.length!==r)throw new Error("Invalid iv size");s=e.slice()},encrypt:function(e){var r=a(o(e));return c=c.concat(n(r)),this.finishEncrypt()},processEncrypt:function(e){return n(a(o(e)))},finishEncrypt:function(){var e=1===u.length?[[u[0]]]:[u];t.pad(e);var r=c.concat(n(a(e)));return i(),r},decrypt:function(e){return this.processDecrypt(e),this.finishDecrypt()},processDecrypt:function(r){var t=function(r){for(var t,n,o=[],a=0;a<r.length;a+=1)t=r[a].slice(0,r[a].length),n=e.decrypt(t),o.push(h.xorVectors(s,n)),s=r[a];return o}(o(r));c=c.concat(n(t))},finishDecrypt:function(){var e=c;return t.unpad(e),i(),e}}};if(void 0!==r){var R={};O.workerEncrypt=function(e){var r,t=e.workerid;return R[t]||(R[t]=O(j.aes(e.keyData)),R[t].init(e.algorithm.iv)),"process"===e.operationSubType?R[t].processEncrypt(e.buffer):"finish"===e.operationSubType?(r=R[t].finishEncrypt(),R[t]=null,r):(r=R[t].encrypt(e.buffer),R[t]=null,r)},O.workerDecrypt=function(e){var r,t=e.workerid;if(R[t]||(R[t]=O(j.aes(e.keyData)),R[t].init(e.algorithm.iv)),"process"!==e.operationSubType)return"finish"===e.operationSubType?(r=R[t].finishDecrypt(),R[t]=null,r):(r=R[t].decrypt(e.buffer),R[t]=null,r);R[t].processDecrypt(e.buffer)},O.generateKey=function(e){if(e.algorithm.length%8!=0)throw new Error;return{type:"keyGeneration",keyData:J.getBytes(Math.floor(e.algorithm.length/8)),keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:"secret"}}},O.importKey=function(e){var r,t=8*e.keyData.length;if("jwk"===e.format)r=d.jwkToKey(e.keyData,e.algorithm,["k"]);else{if("raw"!==e.format)throw new Error("unsupported import format");if(128!==t&&192!==t&&256!==t)throw new Error("invalid key length (should be 128, 192, or 256 bits)");r={k:h.toArray(e.keyData)}}return e.algorithm.length=8*r.k.length,{keyData:r.k,keyHandle:{algorithm:e.algorithm,extractable:e.extractable||r.extractable,usages:e.usages,type:"secret"},type:"keyImport"}},O.exportKey=function(e){if("jwk"===e.format)return{type:"keyExport",keyHandle:d.keyToJwk(e.keyHandle,e.keyData)};if("raw"===e.format)return{type:"keyExport",keyHandle:e.keyData};throw new Error("unsupported export format")},r.register("importKey","aes-cbc",O.importKey),r.register("exportKey","aes-cbc",O.exportKey),r.register("generateKey","aes-cbc",O.generateKey),r.register("encrypt","aes-cbc",O.workerEncrypt),r.register("decrypt","aes-cbc",O.workerDecrypt)}var Z=function(e){var r,t,n,o,a,i,s=h,u=[],c=e.encrypt(s.getVector(16)),l=s.getVector(16),f=[],y=[],g=0;function p(e,r){for(var t,n=Math.floor(r.length/16),o=0;o<n;o++)t=r.slice(16*o,16*o+16),l=v(s.xorVectors(l,t),e);return f=r.slice(16*n),l}function d(){var e=16*Math.ceil(g/16)-g,r=k(8*t.length),n=k(8*g),o=f.concat(s.getVector(e)).concat(r).concat(n);return p(c,o)}function v(e,r){var t,n,o,a,i,u,c=s.getVector(16),l=r.slice(0);for(o=0;o<128;o++){for(t=255&(a=e,i=o,u=void 0,u=Math.floor(i/8),-(a[u]>>7-i%8&1)),n=0;n<16;n++)c[n]=c[n]^l[n]&t;t=255&-(1&l[15]),m(l),l[0]^=225&t}return c}function m(e){for(var r=e.length-1;r>0;r--)e[r]=(1&e[r-1])<<7|e[r]>>>1;return e[0]=e[0]>>>1,e}function w(e){for(var r=256,t=1;t<=4;t++)r=(r>>>8)+e[e.length-t],e[e.length-t]=255&r;return e}function b(r,t){var n,o=Math.ceil(t.length/16),a=[];i!==r&&(i=r.slice());for(var u=0;u<o;u++){n=t.slice(16*u,16*u+16);var c=e.encrypt(i.slice());a=a.concat(s.xorVectors(n,c)),i=w(i)}return a}function k(e){return[0,0,0,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e]}function x(){g=0,u=[],y=[],l=s.getVector(16),f=[],i=r=t=null}return{init:function(e,i,u){if(t=i||[],(n=isNaN(u)?128:u)%8!=0)throw new Error("DataError");if(12===(r=e).length)o=r.concat([0,0,0,1]);else{var f=16*Math.ceil(r.length/16)-r.length;o=p(c,r.concat(s.getVector(f+8)).concat(k(8*r.length))),l=s.getVector(16)}var h,y;a=w(o.slice()),p(c,(h=t,y=16*Math.ceil(t.length/16)-t.length,h.concat(s.getVector(y))))},encrypt:function(e){g=e.length;var r=b(a,e);p(c,r);var t=d(),i=b(o,t).slice(0,n/8);return x(),r.slice().concat(i)},decrypt:function(e,r){g=e.length;var t=b(a,e);p(c,e);var i=d(),u=b(o,i).slice(0,n/8);return x(),s.arraysEqual(u,r)?t:null},processEncrypt:function(e){var r=(u=u.concat(e)).slice(0,16*Math.floor(u.length/16));g+=r.length,u=u.slice(r.length);var t=b(i||a,r);y=y.concat(t),p(c,t)},processDecrypt:function(e){var r=(u=u.concat(e)).slice(0,16*Math.floor((u.length-n/8)/16));g+=r.length,u=u.slice(r.length);var t=b(i||a,r);y=y.concat(t),p(c,r)},finishEncrypt:function(){var e=b(i,u);y=y.concat(e),g+=u.length;var r=d(),t=b(o,r).slice(0,n/8),a=y.slice().concat(t);return x(),a},finishDecrypt:function(){var e=Math.floor(n/8),r=u.slice(-e);u=u.slice(0,u.length-e);var t=b(i,u);y=y.concat(t),g+=u.length;var a=d(),c=b(o,a).slice(0,n/8),l=y.slice();return x(),s.arraysEqual(c,r)?l:null}}};if(void 0!==r){var G={};Z.encrypt=function(e){var r,t=e.workerid;if(G[t]||(G[t]=Z(j.aes(e.keyData)),G[t].init(e.algorithm.iv,e.algorithm.additionalData,e.algorithm.tagLength)),"process"!==e.operationSubType)return"finish"===e.operationSubType?(r=G[t].finishEncrypt(),G[t]=null,r):(r=G[t].encrypt(e.buffer),G[t]=null,r);G[t].processEncrypt(e.buffer)},Z.decrypt=function(e){var r,t=e.workerid;if(G[t]||(G[t]=Z(j.aes(e.keyData)),G[t].init(e.algorithm.iv,e.algorithm.additionalData,e.algorithm.tagLength)),"process"!==e.operationSubType){if("finish"===e.operationSubType){if(r=G[t].finishDecrypt(),G[t]=null,null===r)throw new Error("OperationError");return r}var n=e.algorithm.tagLength?Math.floor(e.algorithm.tagLength/8):16,o=e.buffer.slice(0,e.buffer.length-n),a=e.buffer.slice(-n);if(r=G[t].decrypt(o,a),G[t]=null,null===r)throw new Error("OperationError");return r}G[t].processDecrypt(e.buffer)},Z.generateKey=function(e){if(e.algorithm.length%8!=0)throw new Error;return{type:"keyGeneration",keyData:J.getBytes(Math.floor(e.algorithm.length/8)),keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:"secret"}}},Z.importKey=function(e){var r,t=8*e.keyData.length;if("jwk"===e.format)r=d.jwkToKey(e.keyData,e.algorithm,["k"]);else{if("raw"!==e.format)throw new Error("unsupported import format");if(128!==t&&192!==t&&256!==t)throw new Error("invalid key length (should be 128, 192, or 256 bits)");r={k:h.toArray(e.keyData)}}return{type:"keyImport",keyData:r.k,keyHandle:{algorithm:e.algorithm,extractable:e.extractable||r.extractable,usages:e.usages,type:"secret"}}},Z.exportKey=function(e){if("jwk"===e.format)return{type:"keyExport",keyHandle:d.keyToJwk(e.keyHandle,e.keyData)};if("raw"===e.format)return{type:"keyExport",keyHandle:e.keyData};throw new Error("unsupported export format")},r.register("importKey","aes-gcm",Z.importKey),r.register("exportKey","aes-gcm",Z.exportKey),r.register("generateKey","aes-gcm",Z.generateKey),r.register("encrypt","aes-gcm",Z.encrypt),r.register("decrypt","aes-gcm",Z.decrypt)}function V(){if(!(this instanceof V))throw new Error("create MsrcryptoPrng object with new keyword");var e,r,t,n,o=!1,a=1,i=Math.pow(2,48);function s(e){var r;for(r=e.length-1;r>=0&&(e[r]+=1,e[r]>=256&&(e[r]=0),!e[r]);r-=1);}function u(){e=h.getVector(32),r=h.getVector(16),t=32,n=48,a=1}function c(e,r){if((r=r||[0]).length>n)throw new Error("Incorrect entropy or additionalEntropy length");r=r.concat(h.getVector(n-r.length)),e=e.concat(h.getVector((n-e.length%n)%n));for(var t=0;t<e.length;t+=n)l(h.xorVectors(e.slice(t,t+n),r));a=1}function l(o){for(var a=[],i=new j.aes(e);a.length<n;){s(r);var u=r.slice(0,16),c=i.encrypt(u);a=a.concat(c)}a=h.xorVectors(a,o),e=a.slice(0,t),r=a.slice(t)}function f(t,o){if(t>=65536)throw new Error("too much random requested");if(a>i)throw new Error("Reseeding is required");if(o&&o.length>0){for(;o.length<n;)o=o.concat(h.getVector(n-o.length));l(o)}else o=h.getVector(n);for(var u=[],c=new j.aes(e);u.length<t;){s(r);var f=r.slice(0,r.length),y=c.encrypt(f);u=u.concat(y)}return u=u.slice(0,t),l(o),a+=1,u}return u(),{reseed:c,getBytes:function(e,r){if(!o)throw new Error("can't get randomness before initialization");return f(e,r)},getNonZeroBytes:function(e,r){if(!o)throw new Error("can't get randomness before initialization");for(var t,n=[];n.length<e;){t=f(e,r);for(var a=0;a<t.length;a+=1)0!==t[a]&&n.push(t[a])}return n.slice(0,e)},init:function(e,r){if(e.length<n)throw new Error("Initial entropy length too short");u(),c(e,r),o=!0}}}var J=new V;var Q,Y=function(){var e=[],r=[],t=16384;function n(t){var n,o=r.length;for(n=0;n<o;n++)if((r[n]+t)%e[n]==0)return!1;return!0}function o(n){var o,a,i,s,u,c,l=n.length-1,f=v.DIGIT_BASE,h=n[l];for(0===e.length&&(e=function(e){var r,t,n=new Array(e+1),o=[],a=0|Math.sqrt(e);for(r=3;r<=a;r+=2)for(t=r*r;t<=e;t+=2*r)n[t]=0;for(r=3;r<=e;r+=2)0!==n[r]&&o.push(r);return o}(t)),c=e.length,r=new Array(c),o=0;o<c;o++){for(a=l,h<(u=e[o])?(i=h,a--):i=0;a>=0;)i=(s=i*f+n[a--])-(s/u|0)*u;r[o]=i}}function a(e,r){var t=e,n=[];v.subtract(t,[1],n);var o=function(e){var r,t=0,n=0;if(v.isZero(e))return 0;for(t=0;0===e[t];t++);for(n=0,r=2;e[t]%r==0;r*=2,n++);return t*v.DIGIT_BITS+n}(n),a=[];v.shiftRight(n,a,o);for(var s,u=function(e){var r=0,t=0,n=0;if(v.isZero(e))return 0;for(r=e.length-1;0===e[r];r--);for(n=1<<(t=v.DIGIT_BITS-1);t>0&&0==(e[r]&n);n>>>=1,t--);return r*v.DIGIT_BITS+t}(t),c=v.MontgomeryMultiplier(t),l=1;l<=r;l++){var f=!1;do{s=i(u)}while(v.compareDigits(s,n)>=0);var h=[];if(c.modExp(s,a,h,!0),0!==v.compareDigits(h,[1])&&0!==v.compareDigits(h,n)){for(var y=1;y<o;y++){if(c.montgomeryMultiply(h,h,h),0===v.compareDigits(h,n)){f=!0;break}if(0===v.compareDigits(h,[1]))return!1}if(!1===f)return!1}}return!0}function i(e){var r=Math.ceil(e/8),t=J.getBytes(r);return t[0]|=128,t[t.length-1]|=1,v.bytesToDigits(t)}return{generatePrime:function(e){var r=i(e),t=0,s=[];for(o(r);;){if(n(t)&&(v.add(r,[t],s),!0===a(s,6)))return s;t+=2}}}}(),_=function(e){var r=h,t=e.hasOwnProperty("n")&&e.hasOwnProperty("d"),n=e.hasOwnProperty("p")&&e.hasOwnProperty("q"),o=e.n.length;function a(e){var t=v.digitsToBytes(e);return r.padFront(t,0,o),t}function i(e,r,t){var n=v.bytesToDigits(r),o=v.IntegerGroup(t),a=o.createElementFromBytes(e);return o.modexp(a,n).m_digits}return{encrypt:function(r){return a(i(r,e.e,e.n))},decrypt:function(r){if(n)return function(r){var t=v.bytesToDigits,n=e.p,o=e.q,i=e.dp,s=e.dq,u=e.qi,c=t(n),l=t(o),f=new Array(c.length+l.length),h=new Array(c.length+1),y=new Array(l.length+1),g=t(r),p=v.MontgomeryMultiplier,d=new p(e.ctxp?void 0:c,e.ctxp),m=new p(e.ctxq?void 0:l,e.ctxq);d.reduce(g,f),d.modExp(f,t(i),h),m.reduce(g,f),m.modExp(f,t(s),y);var w=v.subtract(h,y,f);return 0!==w&&v.subtract(y,h,f),v.modMul(f,t(u),c,g),0!==w&&v.subtract(c,g,g),v.multiply(g,l,f),v.add(y,f,h),a(h)}(r);if(t)return function(r){return a(i(r,e.d,e.n))}(r);throw new Error("missing private key")}}},X={mgf1:function(e,r,t){var n,o,a,i=[],s=t.hashLen/8;for(a=0;a<=Math.floor(r/s);a+=1)n=[a>>>24&255,a>>>16&255,a>>>8&255,255&a],o=t.computeHash(e.concat(n)),i=i.concat(o);return i.slice(0,r)},checkMessageVsMaxHash:function(e,r){if(e.length>(r.maxMessageSize||4294967295))throw new Error("message too long")}};(Q=Q||{}).oaep=function(e,r){var t=h,n=J,o=e.n.length;if(null===r)throw new Error("must supply hashFunction");return{pad:function(e,a){return function(e,a){var i,s,u,c,l,f,h,y,g;if(e.length>o-r.hashLen/8*2-2)throw new Error("Message too long.");return null==a&&(a=[]),i=r.computeHash(a),s=o-e.length-2*i.length-2,u=t.getVector(s),c=i.concat(u,[1],e),l=n.getBytes(i.length),f=X.mgf1(l,o-i.length-1,r),h=t.xorVectors(c,f),y=X.mgf1(h,i.length,r),g=t.xorVectors(l,y),e=[0].concat(g).concat(h).slice()}(e,a)},unpad:function(e,n){return function(e,n){var a,i,s,u,c,l,f,h,y=0;if(n||(n=[]),a=r.computeHash(n),0!==e[0])throw new Error("Encryption Error");if(i=e.slice(1,a.length+1),s=e.slice(a.length+1),u=X.mgf1(s,a.length,r),c=t.xorVectors(i,u),l=X.mgf1(c,o-a.length-1,r),h=(f=t.xorVectors(s,l)).slice(0,a.length),!t.arraysEqual(a,h))throw new Error("Encryption Error");for(f=f.slice(a.length);!f[y++];);return f.slice(y)}(e,n)}}},(Q=Q||{}).pkcs1Sign=function(e,r){var t=h,n=e.n.length;function o(e){var o,a,i;if(a=r.computeHash(e.slice()),i=(o=r.der.concat(a)).length,n<i+11)throw new Error("intended encoded message length too short");return[0,1].concat(t.getVector(n-i-3,255),[0],o)}return{sign:function(e){return o(e)},verify:function(e,r){var n=o(r);return t.arraysEqual(e,n)}}},(Q=Q||{}).pss=function(e,r){var t=h,n=J;return{sign:function(o,a,i){return function(o,a,i){var s=v.bitLength(e.n)-1,u=Math.ceil(s/8),c=r.computeHash(o);if(a=i?i.length:null==a?c.length:a,u<c.length+a+2)throw new Error("encoding error");i=i||n.getBytes(a);for(var l=[0,0,0,0,0,0,0,0].concat(c,i),f=r.computeHash(l),h=t.getVector(u-i.length-f.length-2).concat([1],i),y=X.mgf1(f,u-f.length-1,r),g=t.xorVectors(h,y),p=0,d=0;d<8-(8*u-s);d++)p+=1<<d;return g[0]&=p,g.concat(f,[188])}(o,a,i)},verify:function(n,o,a){return function(n,o,a){var i=v.bitLength(e.n)-1,s=Math.ceil(i/8),u=r.computeHash(o),c=u.length;if(s<c+(a=null==a?c:a)+2)return!1;var l=n.slice(0,s-c-1),f=n.slice(l.length,l.length+c),h=X.mgf1(f,s-c-1,r),y=t.xorVectors(l,h);y[0]&=255>>>8-(8*s-i);for(var g=0;g<s-c-a-2;g++)if(0!==y[g])return!1;if(1!==y[s-c-a-2])return!1;var p=y.slice(y.length-a),d=[0,0,0,0,0,0,0,0].concat(u,p),m=r.computeHash(d);return t.arraysEqual(m,f)}(n,o,a)}}};var $=function(e,r,t){var n=_(e);if(!r)throw new Error("padding mode");function o(){if(!t||!t.computeHash)throw new Error("missing hash function")}var a,i=null,s=null;switch(r){case"rsassa-pkcs1-v1_5":o(),a=Q.pkcs1Sign(e,t);break;case"rsa-oaep":o(),a=Q.oaep(e,t);break;case"rsa-pss":o(),a=Q.pss(e,t);break;case"raw":a={pad:function(e){return e},unpad:function(e){return e}};break;default:throw new Error("invalid mode")}return a&&(i=a.pad||a.sign,s=a.unpad||a.verify),{encrypt:function(e,r){var t;return t=null!==i?i(e,r):e.slice(),n.encrypt(t)},decrypt:function(e,r){var t=n.decrypt(e);return t=null!==s?s(t,r):t.slice(0)},signData:function(e,r,t){return n.decrypt(i(e,r,t))},verifySignature:function(e,r,t){var o=n.encrypt(e);return s(o,r,t)},generateKeyPair:function(e){genRsaKeyFromRandom(e)},mode:r}};void 0!==r&&($.sign=function(e){var r=e.keyHandle.algorithm.hash.name,t=f[r.toLowerCase()](),n=e.algorithm.saltLength,o=e.algorithm.salt;return $(e.keyData,e.algorithm.name,t).signData(e.buffer,n,o)},$.verify=function(e){var r=e.keyHandle.algorithm.hash.name,t=f[r.toLowerCase()](),n=e.algorithm.saltLength;return $(e.keyData,e.algorithm.name,t).verifySignature(e.signature,e.buffer,n)},$.workerEncrypt=function(e){var r,t,n;switch(e.algorithm.name){case"rsa-oaep":if(!(n=e.keyHandle.algorithm.hash.name))throw new Error("unsupported hash algorithm");t=f[n.toLowerCase()](),r=$(e.keyData,e.algorithm.name,t).encrypt(e.buffer);break;default:throw new Error("unsupported algorithm")}return r},$.workerDecrypt=function(e){var r,t;switch(e.algorithm.name){case"rsa-oaep":var n=e.keyHandle.algorithm.hash.name;if(!n)throw new Error("unsupported hash algorithm");t=f[n.toLowerCase()](),r=$(e.keyData,e.algorithm.name,t).decrypt(e.buffer);break;default:throw new Error("unsupported algorithm")}return r},$.importKey=function(e){var r;if("jwk"===e.format)(r=d.jwkToKey(e.keyData,e.algorithm,["n","e","d","q","p","dq","dp","qi"])).d&&(r.ctxp=new v.MontgomeryMultiplier(v.bytesToDigits(r.p)).ctx,r.ctxq=new v.MontgomeryMultiplier(v.bytesToDigits(r.q)).ctx);else{if("spki"!==e.format)throw new Error("unsupported key import format.");var t=y.parse(e.keyData);if(null==t)throw new Error("invalid key data.");var n=t[1],o=y.parse(n.data.slice(n.header+1),!0);if(null==o)throw new Error("invalid key data.");var a=o[0],i=o[1];if("INTEGER"!==a.type||"INTEGER"!==i.type)throw new Error("invalid key data.");a=a.data.slice(a.header),i=i.data.slice(i.header),0===a[0]&&128&a[1]&&(a=a.slice(1)),0===i[0]&&128&i[1]&&(i=i.slice(1)),r={n:a,e:i}}return{type:"keyImport",keyData:r,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:r.d||r.dq?"private":"public"}}},$.exportKey=function(e){return{type:"keyExport",keyHandle:d.keyToJwk(e.keyHandle,e.keyData)}},$.genRsaKeyFromRandom=function(e,r){var t=r?v.bytesToDigits(r):[65537];do{var n=Y.generatePrime(e/2),o=Y.generatePrime(e/2);if(v.compareDigits(o,n)>0){var a=n;n=o,o=a}var i=[];v.multiply(n,o,i);var s=[];v.subtract(n,[1],s);var u=[];v.subtract(o,[1],u);var c=[];v.multiply(s,u,c);var l=[];v.gcd(t,c,l);var f=0===v.compareDigits(l,v.One)}while(!f);var h=[];v.modInv(t,c,h);var y=[];v.reduce(h,s,y);var g=[];v.reduce(h,u,g);var p=[];v.modInv(o,n,p);var d=v.digitsToBytes;return{privateKey:{n:d(i),e:d(t),d:d(h),p:d(n),q:d(o),dp:d(y),dq:d(g),qi:d(p)},publicKey:{n:d(i),e:d(t)}}},$.generateKeyPair=function(e){if(void 0===e.algorithm.modulusLength)throw new Error("missing modulusLength");var r,t=v.bytesToDigits;switch(e.algorithm.modulusLength){case 1024:case 2048:case 4096:r=$.genRsaKeyFromRandom(e.algorithm.modulusLength,e.algorithm.publicExponent);break;default:throw new Error("invalid modulusLength")}var n=r.privateKey;n.ctxp=new v.MontgomeryMultiplier(t(n.p)).ctx,n.ctxq=new v.MontgomeryMultiplier(t(n.q)).ctx;var o=e.algorithm.name,a=o.slice(o.indexOf("-")+1).toLowerCase(),i="oaep"===a?["encrypt"]:["verify"],s="oaep"===a?["decrypt"]:["sign"];return{type:"keyGeneration",keyPair:{publicKey:{keyData:r.publicKey,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:i,type:"public"}},privateKey:{keyData:r.privateKey,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:s,type:"private"}}}}},r.register("sign","rsassa-pkcs1-v1_5",$.sign),r.register("sign","rsa-pss",$.sign),r.register("verify","rsassa-pkcs1-v1_5",$.verify),r.register("verify","rsa-pss",$.verify),r.register("encrypt","rsa-oaep",$.workerEncrypt),r.register("decrypt","rsa-oaep",$.workerDecrypt),r.register("importKey","rsa-oaep",$.importKey),r.register("importKey","rsassa-pkcs1-v1_5",$.importKey),r.register("importKey","rsa-pss",$.importKey),r.register("exportKey","rsa-oaep",$.exportKey),r.register("exportKey","rsassa-pkcs1-v1_5",$.exportKey),r.register("exportKey","rsa-pss",$.exportKey),r.register("generateKey","rsa-oaep",$.generateKeyPair),r.register("generateKey","rsassa-pkcs1-v1_5",$.generateKeyPair),r.register("generateKey","rsa-pss",$.generateKeyPair));var ee=function(e){var r=h;return{deriveKey:function(t,n,o){for(var a=Math.ceil(o/(e.hashLen/8)),i=1,s=t.concat(n),u=[],c=0;c<a;c++){var l=r.int32ToBytes(i++).concat(s),f=e.computeHash(l);u=u.concat(f)}return u.slice(0,o)}}},re=null;void 0!==r&&(ee.deriveKey=function(e){var r=h,t=e.algorithm.hash.name,n=f[t.toLowerCase()]();re=ee(n);var o=e.algorithm,a=r.toArray(o.algorithmId).concat(r.toArray(o.partyUInfo),r.toArray(o.partyVInfo),r.toArray(o.publicInfo),r.toArray(o.privateInfo)),i=re.deriveKey(e.keyData,a,e.derivedKeyType.length);return re=null,{type:"keyDerive",keyData:i,keyHandle:{algorithm:e.derivedKeyType,extractable:e.extractable,usages:e.usages,type:"secret"}}},ee.deriveBits=function(e){var r=e.algorithm.hash.name,t=f[r.toLowerCase()]();re=ee(t);var n=e.algorithm,o=n.algorithmId.concat(n.partyUInfo,n.partyVInfo,n.publicInfo||[],n.privateInfo||[]),a=re.deriveKey(e.keyData,o,e.length);return re=null,a},r.register("deriveKey","concat",ee.deriveKey),r.register("deriveBits","concat",ee.deriveBits));var te={deriveBits:function(e){var r,t,n=e.algorithm,o=e.keyData,a=e.length,i=n.iterations,s=Array.apply(null,n.salt),u=Math.ceil(a/8),c=[];switch(n.hash.name.toUpperCase()){case"SHA-1":r=20;break;case"SHA-256":r=32;break;case"SHA-384":r=48;break;case"SHA-512":r=64;break;default:throw new Error("Unsupported hash algorithm")}t=Math.ceil(u/r);var l=K.importKey({format:"raw",keyData:o,algorithm:{name:"HMAC",hash:n.hash}}),f={algorithm:n,keyHandle:l.keyHandle,keyData:l.keyData,workerid:0,buffer:null};function h(e,t,n){for(var o=[],a=e.concat([n>>>24&255,n>>>16&255,n>>>8&255,255&n]),i=0;i<t;i++){f.buffer=a,a=K.signHmac(f);for(var s=0;s<r;s++)o[s]=~~o[s]^a[s]}return o}for(var y=1;y<=t;y++)c=c.concat(h(s,i,y));return c.length=u,c}};re=null;void 0!==r&&(te.importKey=function(e){var r;if("raw"!==e.format)throw new Error("unsupported import format");if(r=h.toArray(e.keyData),!1!==e.extractable)throw new Error("only extractable=false is supported.");return{type:"keyImport",keyData:r,keyHandle:{algorithm:{name:"PBKDF2"},extractable:!1,usages:e.usages,type:"secret"}}},r.register("deriveBits","pbkdf2",te.deriveBits),r.register("importKey","pbkdf2",te.importKey));var ne=function(e){var r=v.bytesToDigits,t=v.digitsToBytes,n=e,o=new m.EllipticCurveOperatorFp(e);return{generateKey:function(r){var a=[],i=J.getBytes(e.order.length*v.DIGIT_NUM_BYTES);v.reduce(v.bytesToDigits(i),n.order,a);var s=n.allocatePointStorage();return o.scalarMultiply(a,n.generator,s),{privateKey:{x:t(s.x),y:t(s.y),d:t(a)},publicKey:{x:t(s.x),y:t(s.y)}}},deriveBits:function(e,t,a){var i=new m.EllipticCurvePointFp(n,!1,r(t.x),r(t.y),null,!1),s=n.allocatePointStorage();o.convertToJacobianForm(s),o.convertToMontgomeryForm(s),o.scalarMultiply(r(e.d),i,s),o.convertToAffineForm(s),o.convertToStandardForm(s);var u=v.digitsToBytes(s.x,!0,t.x.length);if(a&&8*u.length<a)throw new Error("DataError");var c=a%8,l=0===c?255:65280>>>c;return(u=a?u.slice(0,Math.ceil(a/8)):u)[u.length-1]=u[u.length-1]&l,u},computePublicKey:function(e){n.generator.isInMontgomeryForm||o.convertToMontgomeryForm(n.generator);var a=n.allocatePointStorage();return o.convertToJacobianForm(a),o.convertToMontgomeryForm(a),o.scalarMultiply(r(e),n.generator,a),{x:t(a.x),y:t(a.y)}}}};void 0!==r&&(ne.deriveBits=function(e){var r=m.createCurve(e.algorithm.namedCurve.toUpperCase()),t=e.keyData,n=e.additionalKeyData;return ne(r).deriveBits(t,n,e.length)},ne.deriveKey=function(e){throw new Error("not supported")},ne.generateKey=function(e){var r=m.createCurve(e.algorithm.namedCurve.toUpperCase()),t=ne(r).generateKey();return{type:"keyPairGeneration",keyPair:{publicKey:{keyData:t.publicKey,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:[],type:"public"}},privateKey:{keyData:t.privateKey,keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:e.usages,type:"private"}}}}},ne.importKey=function(e){if("raw"===e.format){var r=e.keyData;if(4!==r[0])throw new Error("DataError");var t=~~((r.length-1)/2),n=e.algorithm.namedCurve.toUpperCase(),o=r.slice(1,t+1),a=r.slice(t+1);if(!1===m.validatePoint(n,o,a))throw new Error("DataError");return{type:"keyImport",keyData:{x:o,y:a},keyHandle:{algorithm:e.algorithm,extractable:e.extractable||i.extractable,usages:e.usages,type:"public"}}}if("jwk"===e.format){var i=d.jwkToKey(e.keyData,e.algorithm,["x","y","d","crv"]);if(i.d&&(!i.x||!i.y)){var s=m.createCurve(e.algorithm.namedCurve.toUpperCase()),u=ne(s).computePublicKey(i.d);i.x=u.x,i.y=u.y}if(!1===m.validatePoint(e.algorithm.namedCurve.toUpperCase(),i.x,i.y))throw new Error("DataError");return{type:"keyImport",keyData:i,keyHandle:{algorithm:e.algorithm,extractable:e.extractable||i.extractable,usages:e.usages,type:i.d?"private":"public"}}}},ne.exportKey=function(e){if("raw"===e.format&&"public"===e.keyHandle.type)return{type:"keyExport",keyHandle:[4].concat(e.keyData.x,e.keyData.y)};if("jwk"===e.format)return{type:"keyExport",keyHandle:d.keyToJwk(e.keyHandle,e.keyData)};throw new Error("unsupported export format.")},r.register("importKey","ecdh",ne.importKey),r.register("exportKey","ecdh",ne.exportKey),r.register("generateKey","ecdh",ne.generateKey),r.register("deriveBits","ecdh",ne.deriveBits),r.register("deriveKey","ecdh",ne.deriveKey));var oe,ae=function(e){var r=v.bytesToDigits,t=v.digitsToBytes,n=new m.EllipticCurveOperatorFp(e),o=t(e.order).length,a=1===e.type;function i(r){var t=e.allocatePointStorage();return n.scalarMultiply(r,e.generator,t),{publicKey:t,privateKey:r}}function s(r){var t=[];return r||(r=J.getBytes(e.order.length*v.DIGIT_NUM_BYTES)),v.reduce(v.bytesToDigits(r),e.order,t),i(t)}function u(t){t.length>o&&(t.length=o);var n=r(t);if(a){var i=8-e.rbits%8;v.shiftRight(n,n,i)}return v.reduce(n,e.order,n),n}return{createKey:function(e){return i(r(e))},generateKey:s,sign:function(n,a,i){i||(i=s());var c=i.publicKey.x,l=i.privateKey,f=r(n.d),y=u(a.slice()),g=[],p=[];v.reduce(c,e.order,c),v.modMul(c,f,e.order,g),v.add(g,y,g),v.reduce(g,e.order,g),v.modInvCT(l,e.order,p),v.modMul(g,p,e.order,g);var d=h.padFront(t(c,!0,o),0,o),m=h.padFront(t(g,!0,o),0,o);return d.concat(m)},verify:function(t,o,i){var s=Math.floor(o.length/2),c=r(o.slice(0,s)),l=r(o.slice(s)),f=u(i.slice()),h=[],y=[],g=new m.EllipticCurvePointFp(e,!1,r(t.x),r(t.y),null,!1);v.modInv(l,e.order,l),v.modMul(f,l,e.order,h),v.modMul(c,l,e.order,y);var p=e.allocatePointStorage(),d=e.allocatePointStorage();return a?(v.add(h,h,h),v.add(h,h,h),v.reduce(h,e.order,h),n.scalarMultiply(h,e.generator,p,!1),n.scalarMultiply(y,g,d,!1),n.convertToExtendedProjective(p),n.convertToExtendedProjective(d),n.add(d,p,p),n.normalize(p)):(n.scalarMultiply(h,e.generator,p),n.scalarMultiply(y,g,d),n.convertToJacobianForm(p),n.convertToMontgomeryForm(p),n.convertToMontgomeryForm(d),n.mixedAdd(p,d,p),n.convertToAffineForm(p),n.convertToStandardForm(p)),!p.isInfinity&&(v.reduce(p.x,e.order,p.x),0===v.compareDigits(p.x,c))}}};void 0!==r&&(ae.sign=function(e){h.checkParam(e.algorithm.hash,"Object","algorithm.hash"),h.checkParam(e.algorithm.hash.name,"String","algorithm.hash.name"),h.checkParam(e.keyHandle.algorithm.namedCurve,"String","p.keyHandle.algorithm.namedCurve");var r=e.algorithm.hash.name,t=m.createCurve(e.keyHandle.algorithm.namedCurve.toUpperCase()),n=f[r.toLowerCase()]().computeHash(e.buffer);return ae(t).sign(e.keyData,n)},ae.verify=function(e){var r=e.algorithm.hash.name,t=m.createCurve(e.keyHandle.algorithm.namedCurve.toUpperCase()),n=f[r.toLowerCase()]().computeHash(e.buffer);return ae(t).verify(e.keyData,e.signature,n)},ae.generateKey=function(e){var r=m.createCurve(e.algorithm.namedCurve.toUpperCase()),t=ae(r).generateKey(),n=v.digitsToBytes;function o(e){return e}var a=o(n(t.publicKey.x)),i=o(n(t.publicKey.y)),s=o(n(t.privateKey));return{type:"keyPairGeneration",keyPair:{publicKey:{keyData:{x:a,y:i},keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:["verify"],type:"public"}},privateKey:{keyData:{x:a,y:i,d:s},keyHandle:{algorithm:e.algorithm,extractable:e.extractable,usages:["sign"],type:"private"}}}}},ae.importKey=function(e){if("raw"===e.format){var r=e.keyData;if(4!==r[0])throw new Error("DataError");var t=~~((r.length-1)/2),n=e.algorithm.namedCurve.toUpperCase(),o=r.slice(1,t+1),a=r.slice(t+1);if(!1===m.validatePoint(n,o,a))throw new Error("DataError");return{type:"keyImport",keyData:{x:o,y:a},keyHandle:{algorithm:e.algorithm,extractable:e.extractable||i.extractable,usages:e.usages,type:"public"}}}if("jwk"===e.format){var i=d.jwkToKey(e.keyData,e.algorithm,["x","y","d","crv"]);if(i.d&&(!i.x||!i.y)){var s=ae.curves[e.algorithm.namedCurve](),u=ae(s).computePublicKey(i.d);i.x=u.x,i.y=u.y}if(!1===m.validatePoint(e.algorithm.namedCurve.toUpperCase(),i.x,i.y))throw new Error("DataError");return{type:"keyImport",keyData:i,keyHandle:{algorithm:e.algorithm,extractable:e.extractable||i.extractable,usages:e.usages,type:i.d?"private":"public"}}}},ae.exportKey=function(e){if("raw"===e.format&&"public"===e.keyHandle.type)return{type:"keyExport",keyHandle:[4].concat(e.keyData.x,e.keyData.y)};if("jwk"===e.format)return{type:"keyExport",keyHandle:d.keyToJwk(e.keyHandle,e.keyData)};throw new Error("unsupported export format.")},r.register("sign","ecdsa",ae.sign),r.register("verify","ecdsa",ae.verify),r.register("generateKey","ecdsa",ae.generateKey),r.register("importKey","ecdsa",ae.importKey),r.register("exportKey","ecdsa",ae.exportKey));var ie=h;oe=function(){function e(){var e;return{postMessage:function(r){try{r.workerid=this.id,e=g.jsCryptoRunner({data:r})}catch(e){return void this.onerror({data:e,type:"error"})}this.onmessage({data:e})},onmessage:null,onerror:null,terminate:function(){}}}var o=function(e){return{process:function(r){return e.process(r)},finish:function(){return e.finish()},abort:function(){return e.abort()}}};function a(e){var r,t,n;return{dispatchEvent:function(o){"error"!==o.type?"process"!==o.data.type&&"finish"!==o.data.type?(this.result=e(o.data),t.apply(r,[this.result])):e(o.data.result,!0):n&&n.apply(r,[o])},promise:r=new Promise(function(e,r){t=e,n=r}),result:null}}function i(e){var r=[],t=a(function(e,t){var n;if(e=e&&(n=e,s&&n.pop?new Uint8Array(n).buffer:n),!t)return e;r.resolve(e)});return t.stream=e.algorithm.stream,r.add=function(e){var t,n,o=new Promise(function(e,r){t=e,n=r});return o.label=e,r.push({resolve:t,reject:n,promise:o}),o},r.resolve=function(e){var t=r.shift();t.resolve.apply(t.promise,[e])},t.process=function(t){return e.operationSubType="process",e.buffer=ie.toArray(t),l.continueJob(this,ie.clone(e)),r.add("process")},t.finish=function(){return e.operationSubType="finish",e.buffer=[],l.continueJob(this,ie.clone(e)),r.add("finish")},t.abort=function(){l.abortJob(this)},t.algorithm=e.algorithm||null,t.key=e.keyHandle||null,t}var u=[];u.add=function(e,r){u.push({keyHandle:e,keyData:r})},u.remove=function(e){for(var r=0;r<u.length;r+=1)if(u[r].keyHandle===e)return void(u=u.splice(r,1))},u.lookup=function(e){for(var r=0;r<u.length;r+=1)if(u[r].keyHandle===e)return u[r].keyData;return null};var l=function(){var r=12,o=2,a=[],i=[],s=0,u=0,l=[],f="undefined"==typeof setImmediate?setTimeout:setImmediate;function h(){l.shift()()}var y=n?"available":"unavailable";function g(){!function(e){for(var r=a.length-1;r>=0;r-=1)a[r].isWebWorker===e&&(a[r].terminate(),a.splice(r,1))}(!c);for(var e=0;e<a.length;e++)if(!a[e].busy)return a[e];return null}function p(e){for(var r=0;r<a.length;r++)if(a[r]===e)return e.terminate(),void a.splice(r,1)}function d(e){for(var r=0;r<a.length;r++)if(a[r].operation===e)return a[r];return null}function v(e,r){i.push({operation:e,data:r,id:s++})}function m(e){if(e.busy=!1,c)if(i.length>0){var r,t=i.shift();if(k(t.operation,t.data),"process"===t.data.operationSubType){for(r=0;r<i.length;r++)t.operation===i[r].operation&&k(i[r].operation,i[r].data);for(r=i.length-1;r>=0;r--)t.operation===i[r].operation&&i.splice(r,1)}}else(function(){for(var e=0,r=0;r<a.length;r++)a[r].busy||(e+=1);return e})()>o&&p(e)}function w(r){var n;if("pending"===y)throw new Error("Creating new worker while workerstatus=pending");if("ready"===y)try{(n=new Worker(t)).postMessage({prngSeed:J.getBytes(48)}),n.isWebWorker=!0}catch(r){c=!1,y="failed",n.terminate(),(n=e()).isWebWorker=!1}else(n=e()).isWebWorker=!1;return n.operation=r,n.id=u++,n.busy=!1,n.onmessage=function(e){if(!0!==e.data.initialized){var r=n.operation;e.target||(e.target={data:n.data});for(var t=0;t<i.length;t++)if(i[t].operation===n.operation){var o=i[t];return i.splice(t,1),void x(n,o.data)}e.data.hasOwnProperty("type")&&"process"===e.data.type||m(n),r.dispatchEvent(e)}},n.onerror=function(e){var r=n.operation;m(n),r.dispatchEvent(e)},function(e){a.push(e)}(n),n}function b(e,t){var n=null;if("pending"!==y)if(n=g(),c&&null===n&&a.length>=r)v(e,t);else{if(null===n&&(n=w(e)),null===n)throw v(e,t),new Error("could not create new worker");n.operation=e,n.busy=!0,t.workerid=n.id,x(n,t)}else v(e,t)}function k(e,r){var t=d(e);t?x(t,r):b(e,r)}function x(e,r){if(r.workerid=e.id,c)e.postMessage(r);else{var t=(o=r,function(){return e.postMessage(o)});n=t,l.push(n),f(h,0)}var n,o}return{runJob:b,continueJob:k,abortJob:function(e){var r=d(e);r&&p(r)},useWebWorkers:function(e){if("unavailable"!==y){if(!(!0===e&&"ready"===y||!1===e&&"available"===y)){if(!1===e&&"ready"===y)return c=!1,y="available",void ie.consoleLog("web workers disabled.");if("pending"!==y){y="pending";var r=new Worker(t);r.addEventListener("message",n,!1),r.addEventListener("error",n,!1),r.postMessage({prngSeed:J.getBytes(48)})}}}else ie.consoleLog("web workers not available in this browser.");function n(e){var t=!(!e.data||!0!==e.data.initialized);if(r.removeEventListener("message",n,!1),r.removeEventListener("error",n,!1),r.terminate(),y=t?"ready":"failed",c=t,ie.consoleLog("web worker initialization "+(t?"succeeded. Now using web workers.":"failed. running synchronously."+(e.message||""))),i.length>0){var o=i.shift();b(o.operation,o.data)}}}}}(),f=[{name:"algorithm",type:"Object",required:!0},{name:"keyHandle",type:"Object",required:!0},{name:"buffer",type:"Array",required:!1},{name:"signature",type:"Array",required:!0},{name:"format",type:"String",required:!0},{name:"keyData",type:"Object",required:!0},{name:"extractable",type:"Boolean",required:!1},{name:"usages",type:"Array",required:!1},{name:"derivedKeyType",type:"Object",required:!0},{name:"length",type:"Number",required:!1},{name:"extractable",type:"Boolean",required:!0},{name:"usages",type:"Array",required:!0},{name:"keyData",type:"Array",required:!0}],y={encrypt:[0,1,2],decrypt:[0,1,2],sign:[0,1,2],verify:[0,1,3,2],digest:[0,2],generateKey:[0,6,7],importKeyRaw:[4,12,0,10,11],importKeyJwk:[4,5,0,10,11],exportKey:[0,4,1,6,7],deriveKey:[0,1,8,6,7],deriveBits:[0,1,9],wrapKey:[1,1,0],unwrapKey:[2,0,1,6,7]};function p(e){var r=u.lookup(e);if(!r)throw new Error("key not found");return r}function d(e,t,n){var s=function(e,r){var t,n,o,a,i={operationType:e};for("importKey"!==e||"raw"!==r[0]&&"spki"!==r[0]||(e="importKeyRaw"),"importKey"===e&&"jwk"===r[0]&&(e="importKeyJwk"),t=y[e],a=0;a<t.length;a+=1)if(n=f[t[a]],null!=(o=r[a])){if(o.subarray&&(o=ie.toArray(o)),"ArrayBuffer"===ie.getObjectType(o)&&(o=ie.toArray(o)),h.getObjectType(o)!==n.type)throw new Error(n.name);"algorithm"===n.name&&(o.name=o.name.toLowerCase(),o.iv&&(o.iv=ie.toArray(o.iv)),o.publicExponent&&(o.publicExponent=ie.toArray(o.publicExponent)),o.salt&&(o.salt=ie.toArray(o.salt)),o.additionalData&&(o.additionalData=ie.toArray(o.additionalData)),o.hash&&!o.hash.name&&"String"===ie.getObjectType(o.hash)&&(o.hash={name:o.hash})),i.hasOwnProperty(n.name)?i[n.name+"1"]=o:i[n.name]=o}else if(n.required)throw new Error(n.name);return i}(e,t);!function(e,t){if(!r.exists(e,t))throw new Error("unsupported algorithm")}(e,s.algorithm.name),s.keyHandle&&(s.keyData=p(s.keyHandle)),s.keyHandle1&&(s.keyData1=p(s.keyHandle1)),s.algorithm&&s.algorithm.public&&(s.additionalKeyData=p(s.algorithm.public));var c=n?a(function(e){var r,t;switch(e.type){case"keyGeneration":case"keyImport":case"keyDerive":return e.keyPair?(u.add(e.keyPair.publicKey.keyHandle,e.keyPair.publicKey.keyData),u.add(e.keyPair.privateKey.keyHandle,e.keyPair.privateKey.keyData),{publicKey:e.keyPair.publicKey.keyHandle,privateKey:e.keyPair.privateKey.keyHandle}):(u.add(e.keyHandle,e.keyData),e.keyHandle);case"keyExport":return e.keyHandle;case"keyPairGeneration":return t=e.keyPair.privateKey,r=e.keyPair.publicKey,u.add(r.keyHandle,r.keyData),u.add(t.keyHandle,t.keyData),{publicKey:r.keyHandle,privateKey:t.keyHandle};default:throw new Error("Unknown key operation")}}):i(s);return(n||s.buffer||"deriveBits"===e||"wrapKey"===e)&&l.runJob(c,s),c.stream?Promise.resolve(o(c)):c.promise}return{publicMethods:{encrypt:function(e,r,t){return d("encrypt",arguments,0)},decrypt:function(e,r,t){return d("decrypt",arguments,0)},sign:function(e,r,t){return d("sign",arguments,0)},verify:function(e,r,t,n){return d("verify",arguments,0)},digest:function(e,r){return d("digest",arguments,0)},generateKey:function(e,r,t){return d("generateKey",arguments,1)},deriveKey:function(e,r,t,n,o){var a=this.deriveBits,i=this.importKey;return new Promise(function(s,u){var c;switch(t.name.toUpperCase()){case"AES-CBC":case"AES-GCM":c=t.length;break;case"HMAC":c=t.length||{"sha-1":512,"sha-224":512,"sha-256":512,"sha-384":1024,"sha-512":1024}[t.hash.name.toLowerCase()];break;default:return void u(new Error("No Supported"))}a(e,r,c).then(function(e){return i("raw",e,t,n,o)}).then(function(e){s(e)}).catch(function(e){u(e)})})},deriveBits:function(e,r,t){return d("deriveBits",arguments,0)},importKey:function(e,r,t,n,o){return d("importKey",arguments,1)},exportKey:function(e,r){return d("exportKey",[r.algorithm,e,r],1)},wrapKey:function(e,r,t,n){var o=this.encrypt,a=this.exportKey;return new Promise(function(i,s){!1===r.extractable||r.usages.indexOf("wrapKey")<0||t.algorithm.name.toUpperCase()!==n.name?s(new Error("InvalidAccessError")):a(e,r).then(function(r){return o(n,t,"jwk"===e?ie.stringToBytes(JSON.stringify(r,null,0)):r)}).then(function(e){i(e)}).catch(function(e){s(e)})})},unwrapKey:function(e,r,t,n,o,a,i){var s=this.decrypt,u=this.importKey;return new Promise(function(c,l){t.usages.indexOf("unwrapKey")<0||t.algorithm.name.toUpperCase()!==n.name?l(new Error("InvalidAccessError")):s(n,t,r).then(function(r){return u(e,"jwk"===e?JSON.parse(ie.bytesToString(r)):r,o,a,i)}).then(function(e){c(e)}).catch(function(e){l(e)})})}},internalMethods:{useWebWorkers:l.useWebWorkers}}}();var se=function(){var e=h;return{wrapKey:function(r){var t=$(r.keyData1,r.keyHandle1.algorithm.name,f["sha-1"])(),n=d.keyToJwkOld(r.keyHandle,r.keyData),o={alg:r.keyHandle1.algorithm.name.toUpperCase(),enc:"A128GCM"},a=e.toBase64(JSON.stringify(o),!0),i=J.getBytes(32),s=t.encrypt(i),u=e.toBase64(s,!0),c=J.getBytes(12),l=e.toBase64(c,!0),h=a.concat(".",u,".",l),y=Z(j.aes(i));y.init(c,e.stringToBytes(h),128);var g=y.encrypt(n),p=g.slice(-16),v={recipients:[{header:a,encrypted_key:u,integrity_value:e.toBase64(p,!0)}],initialization_vector:l,ciphertext:e.toBase64(g.slice(0,g.length-p.length),!0)};return e.stringToBytes(JSON.stringify(v))},unwrapKey:function(r){var t=e.fromBase64,n=JSON.parse(String.fromCharCode.apply(null,r.buffer)),o=(e.fromBase64(n.recipients[0].header),t(n.recipients[0].encrypted_key)),a=t(n.recipients[0].integrity_value),i=t(n.initialization_vector),s=t(n.ciphertext),u=f["sha-1"](),c=$(r.keyData,r.keyHandle.algorithm.name,u).decrypt(o),l=n.recipients[0].header.concat(".",n.recipients[0].encrypted_key,".",n.initialization_vector),h=Z(j.aes(c));h.init(i,e.stringToBytes(l),128);var y=h.decrypt(s,a),g=d.jwkToKey(y,r.algorithm,["k"]);return{type:"keyImport",keyData:g.k,keyHandle:{algorithm:{name:r.algorithm.name},extractable:r.extractable||g.extractable,usages:r.usages,type:"secret"}}}}}();void 0!==r&&(r.register("wrapKey","aes-gcm",se.wrapKey),r.register("unwrapKey","aes-cbc",se.unwrapKey));var ue,ce={subtle:oe?oe.publicMethods:null,getRandomValues:function(e){var r,t=J.getBytes(e.length);for(r=0;r<e.length;r+=1)e[r]=t[r];return e},initPrng:function(e){var r=Object.prototype.toString.call(e);if("[object Array]"!==r&&"[object Uint8Array]"!==r)throw new Error("entropyData must be a Array or Uint8Array");ue&&ue.reseed(e),J.reseed(ue.read(48))},toBase64:function(e,r){return h.toBase64(e,r)},fromBase64:function(e){return h.fromBase64(e)},textToBytes:function(e){return h.stringToBytes(e)},bytesToText:function(e){return h.bytesToString(e)},asn1:y,url:t,version:msrCryptoVersion,useWebWorkers:function(e){return oe?oe.internalMethods.useWebWorkers(e):null}};(ue=ue||new function(){var r=48,t=[],n=128,o=new V,a=!1,i=!1;function s(){var n,s=["Cookie","RedirectUri","ETag","x-ms-client-antiforgery-id","x-ms-client-request-id","x-ms-client-session-id","SubscriptionPool"],u=[];for(n=0;n<r;n+=1)u[n]=Math.floor(256*Math.random());var f=e.crypto||e.msCrypto;if(f&&"function"==typeof f.getRandomValues&&e.Uint8Array){var y=new e.Uint8Array(r);f.getRandomValues(y),u=u.concat(Array.apply(null,y)),i=!0}if("undefined"!=typeof XMLHttpRequest){var g=new XMLHttpRequest;for(n=0;n<s.length;n+=1)try{var p=g.getResponseHeader(s[n]);if(p){var d=h.stringToBytes(p);u=u.concat(d)}}catch(e){}}!i&&c&&(u=u.concat(t.splice(0,t.length)),l.startCollectors()),a?o.reseed(u):o.init(u),a=!0}function u(e){for(var r=0;r<e.length;++r)t.push(e[r]);t.length>=n&&l.stopCollectors()}var c=e&&e.addEventListener||"undefined"!=typeof document&&document.attachEvent,l={startCollectors:function(){if(!this.collectorsRegistered){if(e.addEventListener)e.addEventListener("mousemove",this.MouseEventCallBack,!0),e.addEventListener("load",this.LoadTimeCallBack,!0);else{if(!document.attachEvent)throw new Error("Can't attach events for entropy collection");document.attachEvent("onmousemove",this.MouseEventCallBack),document.attachEvent("onload",this.LoadTimeCallBack)}this.collectorsRegistered=1}},stopCollectors:function(){this.collectorsRegistered&&(e.removeEventListener?(e.removeEventListener("mousemove",this.MouseEventCallBack,1),e.removeEventListener("load",this.LoadTimeCallBack,1)):e.detachEvent&&(e.detachEvent("onmousemove",this.MouseEventCallBack),e.detachEvent("onload",this.LoadTimeCallBack)),this.collectorsRegistered=0)},MouseEventCallBack:function(e){var r=(new Date).valueOf(),t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0;u([255&r,r>>8&255,r>>16&255,r>>24&255,255&t,t>>8&255,255&n,n>>8&255])},LoadTimeCallBack:function(){var e=(new Date).valueOf();u([255&e,e>>8&255,e>>16&255,e>>24&255])}};return{init:function(){if(s(),!i&&c)try{l.startCollectors()}catch(e){}},reseed:function(e){o.reseed(e)},read:function(e){if(!a)throw new Error("Entropy pool is not initialized.");var r=o.getBytes(e);return s(),r}}}(e)).init();var le=ue.read(48);return J.init(le),ce}()}),function(e,r){"undefined"==typeof Promise&&(e.Promise=function(){var e=function(r,t){if(!(this instanceof e))throw new Error("use 'new' keyword with Promise constructor");var n=null,o=null,a=[],i=[],s=[],u=[];this.then=function(r,t){var c;return n?(c=r(n.result))&&c.then?c:e.resolve(c):o?(c=t?t(o.result):o.result)&&c.then?c:e.resolve(c):(a.push(r),t&&i.push(t),new e(function(e,r){u.push(e),s.push(r)}))},this.catch=function(r){var t;return o?(t=r(o.result))&&t.then?t:e.resolve(t):(i.push(r),new e(function(e,r){u.push(e),s.push(r)}))},r(function(e){var r,t;for(t=0;t<a.length;t+=1)(r=a[t](e))&&r.then?(r.then(u[t]),s[t]&&r.catch(s[t])):u[t]&&u[t](r);return void(n={result:e})},function(e){var r,t;for(t=0;t<i.length;t+=1)(r=i[t](e))&&r.then?r.then(u[t],s[t]):u[t]&&u[t](r);return void(o={result:e})})};return e.all=function(r){var t=[],n=0;function o(e,o){return function(a){t[e]=a,(n+=1)===r.length&&o(t)}}return new e(function(t,n){var a;function i(e){n(e)}for(a=0;a<r.length;a+=1)r[a].then?(r[a].then(o(a,t)),r[a].catch(i)):e.resolve(r[a]).then(o(a,t))})},e.race=function(r){var t=!1;function n(e){return function(r){t||(t=!0,e(r))}}return new e(function(e,t){for(var o=0;o<r.length;o+=1)r[o].then(n(e),n(t))})},e.reject=function(r){return new e(function(e,t){t(r)})},e.resolve=function(r){return new e(function(e,t){e(r)})},e}())}(this);